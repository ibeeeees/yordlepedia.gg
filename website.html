<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yordlepedia.gg - Your Ultimate League Companion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }

        :root {
            --bg-dark: #1B2D3A;  /* Atlantic Depths */
            --bg-darker: #15232d;  /* Darker Atlantic Depths */
            --bg-card: #4A4E69;  /* Stellar Explorer */
            --bg-card-dark: rgba(74, 78, 105, 0.85);  /* Stellar Explorer with opacity */
            --bg-card-light: rgba(74, 78, 105, 0.6);  /* Stellar Explorer with opacity */
            --profile-spacing: 48px;  /* New spacing variable */
            --accent: #F2CC8F;  /* Sebright Chicken */
            --accent-strong: #DDA15E;  /* Carnaby Tan */
            
            /* New variables for spacing */
            --profile-banner-height: 320px;
            --profile-info-spacing: 32px;
            --accent-soft: rgba(242, 204, 143, 0.18);  /* Sebright Chicken with opacity */
            --text-main: #F2CC8F;  /* Sebright Chicken */
            --text-muted: #B7B1A5;  /* Coarse Wool */
            --text-soft: #8c8880;  /* Darker Coarse Wool */
            --border: rgba(183, 177, 165, 0.08);  /* Coarse Wool with opacity */
            --border-strong: rgba(221, 161, 94, 0.45);  /* Carnaby Tan with opacity */
            --shadow: 0 30px 80px rgba(27, 45, 58, 0.65);  /* Atlantic Depths with opacity */
            
            /* Profile Stats Box Styles */
            --stat-box-padding: 20px;
            --stat-box-radius: 12px;
            --stat-box-gap: 12px;
            --stat-box-shadow: 0 0 20px rgba(242, 204, 143, 0.05);
            scroll-padding-top: 80px; /* Add padding for fixed header */
            font-size: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            font-family: 'Rajdhani', 'Space Grotesk', 'Segoe UI', sans-serif;
            background: radial-gradient(circle at top, rgba(41, 106, 204, 0.15) 0%, rgba(11, 22, 34, 0.95) 45%, #050a0f 100%);
            color: var(--text-main);
            overflow-x: hidden;
        }

        .profile-banner {
            height: var(--profile-banner-height) !important;
            margin-bottom: var(--profile-info-spacing) !important;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 16px;
            padding: 0 24px 24px;
        }

        .feature-coming-soon {
            position: relative;
            overflow: hidden;
        }

        .feature-coming-soon::after {
            content: 'SOON';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 72px;
            font-weight: 900;
            letter-spacing: 8px;
            opacity: 0.08;
            color: var(--accent);
            pointer-events: none;
            white-space: nowrap;
        }

        a {
            color: inherit;
        }

        h1, h2, h3, h4 {
            font-weight: 800;
            letter-spacing: 1px;
        }

        header {
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(7, 15, 25, 0.95);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        nav {
            max-width: 1250px;
            margin: 0 auto;
            padding: 18px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 30px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            background: linear-gradient(120deg, var(--accent), var(--accent-strong));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: clamp(20px, 3vw, 28px);
            font-weight: 600;
            font-size: clamp(0.85rem, 2vw, 0.95rem);
            letter-spacing: 1px;
            flex-wrap: wrap;
            flex: 1;
            justify-content: center;
        }

        .nav-links a {
            text-decoration: none;
            position: relative;
            padding: 6px 0;
            white-space: nowrap;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(120deg, var(--accent), var(--accent-strong));
            transition: width 0.25s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .profile-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: #0b1524;
            padding: clamp(8px, 2vw, 11px) clamp(18px, 3vw, 26px);
            border: none;
            border-radius: 999px;
            font-weight: 700;
            font-size: clamp(0.85rem, 2vw, 0.95rem);
            letter-spacing: 1px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            white-space: nowrap;
        }

        .profile-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(255, 210, 0, 0.4);
        }

        /* Authentication UI Styles */
        .auth-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .auth-user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-card-light);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .auth-user-info .user-region {
            font-size: 12px;
            color: var(--text-soft);
            background: var(--accent-soft);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .auth-btn {
            padding: 8px 16px;
            background: var(--accent);
            border: none;
            border-radius: 8px;
            color: var(--bg-dark);
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .auth-btn:hover {
            background: var(--accent-strong);
            transform: translateY(-1px);
        }

        .auth-btn.logout {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .auth-btn.logout:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .auth-status {
            padding: 4px 8px;
            background: var(--accent-soft);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .auth-status.authenticated {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .auth-status.expired {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        /* Match Details Modal Styles */
        .match-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            padding: 20px;
        }

        .match-details-modal.active {
            display: flex;
        }

        .match-details-content {
            background: var(--bg-card);
            border-radius: 16px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--border-strong);
        }

        .match-details-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, var(--bg-darker), var(--bg-card-dark));
            border-radius: 16px 16px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .match-details-header h2 {
            color: var(--accent);
            font-size: 24px;
            font-weight: 700;
            margin: 0;
        }

        .match-details-header .close-btn {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .match-details-header .close-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .match-overview {
            padding: 24px;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 24px;
            align-items: center;
            background: var(--bg-card-light);
            margin: 0;
        }

        .team-score-section {
            text-align: center;
        }

        .team-score {
            font-size: 32px;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 4px;
        }

        .score-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .match-info {
            text-align: center;
            padding: 20px;
        }

        .match-info .duration {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-main);
            margin-bottom: 8px;
        }

        .match-info .game-mode {
            color: var(--text-muted);
            font-size: 14px;
        }

        .teams-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }

        .team-section {
            padding: 24px;
        }

        .team-section.blue-team {
            border-right: 1px solid var(--border);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), transparent);
        }

        .team-section.red-team {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), transparent);
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .team-name {
            font-size: 18px;
            font-weight: 600;
        }

        .team-name.blue {
            color: #3b82f6;
        }

        .team-name.red {
            color: #ef4444;
        }

        .team-kda {
            font-size: 16px;
            color: var(--text-muted);
        }

        .players-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .player-row {
            display: grid;
            grid-template-columns: 40px 1fr auto auto auto auto;
            gap: 12px;
            align-items: center;
            padding: 12px;
            background: var(--bg-card-light);
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
        }

        .player-row:hover {
            background: var(--bg-card);
            border-color: var(--accent-soft);
        }

        .clickable-player {
            cursor: pointer;
            position: relative;
        }

        .clickable-player::after {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, transparent, var(--accent-soft), transparent);
            border-radius: 9px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .clickable-player:hover {
            background: var(--bg-card);
            border-color: var(--accent);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .clickable-player:hover::after {
            opacity: 0.3;
        }

        .clickable-player:hover .click-indicator {
            opacity: 1;
            animation: bounceIn 0.3s ease;
        }

        .click-indicator {
            position: absolute;
            top: -8px;
            right: 8px;
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            z-index: 10;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Notification System */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px 16px;
            min-width: 300px;
            max-width: 500px;
            z-index: 10000;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.hide {
            transform: translateX(100%);
            opacity: 0;
        }

        .notification.info {
            border-left: 4px solid var(--accent);
        }

        .notification.success {
            border-left: 4px solid #4ade80;
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-icon {
            font-size: 16px;
            flex-shrink: 0;
        }

        .notification-message {
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.4;
        }

        .click-indicator::before {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 4px solid var(--accent);
        }

        .player-champion {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background-size: cover;
            background-position: center;
            border: 2px solid var(--border);
        }

        .player-info {
            display: flex;
            flex-direction: column;
        }

        .player-name {
            font-weight: 600;
            color: var(--text-main);
            font-size: 14px;
        }

        .player-role {
            font-size: 12px;
            color: var(--text-soft);
        }

        .player-kda {
            font-weight: 600;
            font-size: 14px;
            color: var(--text-main);
            text-align: center;
        }

        .player-cs {
            font-size: 13px;
            color: var(--text-muted);
            text-align: center;
        }

        .player-damage {
            font-size: 13px;
            color: var(--text-muted);
            text-align: center;
        }

        .player-items {
            display: flex;
            gap: 2px;
        }

        .item-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            background-size: cover;
            background-position: center;
            border: 1px solid var(--border);
        }

        .item-icon.empty {
            background: var(--bg-darker);
        }

        .objectives-section {
            padding: 24px;
            background: var(--bg-card-dark);
            border-top: 1px solid var(--border);
        }

        .objectives-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .objectives-team {
            display: flex;
            justify-content: space-around;
            padding: 16px;
            background: var(--bg-card-light);
            border-radius: 8px;
        }

        .objective-item {
            text-align: center;
        }

        .objective-icon {
            font-size: 20px;
            margin-bottom: 4px;
            display: block;
        }

        .objective-count {
            font-weight: 600;
            color: var(--text-main);
        }

        .objective-name {
            font-size: 11px;
            color: var(--text-soft);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Stat Explanations Styles */
        .stat-explanations {
            margin-top: 40px;
            padding: 32px;
            background: var(--bg-card-dark);
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .stat-explanations h3 {
            color: var(--accent);
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            text-align: center;
        }

        .explanations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .explanation-card {
            background: var(--bg-card-light);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .explanation-card:hover {
            background: var(--bg-card);
            border-color: var(--accent-soft);
            transform: translateY(-2px);
        }

        .explanation-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .explanation-header h4 {
            color: var(--text-main);
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .stat-icon-small {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .explanation-card p {
            color: var(--text-muted);
            margin-bottom: 12px;
            font-size: 14px;
        }

        .explanation-card ul {
            margin: 0;
            padding-left: 20px;
            color: var(--text-main);
        }

        .explanation-card li {
            margin-bottom: 6px;
            font-size: 13px;
            line-height: 1.4;
        }

        .explanation-card li strong {
            color: var(--accent);
        }

        .formula {
            margin-top: 16px;
            padding: 12px;
            background: var(--accent-soft);
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-main);
            text-align: center;
            border-left: 3px solid var(--accent);
        }

        @media (max-width: 768px) {
            .stat-explanations {
                margin-top: 20px;
                padding: 20px;
            }

            .explanations-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .explanation-card {
                padding: 16px;
            }

            .stat-explanations h3 {
                font-size: 20px;
                margin-bottom: 16px;
            }

            .match-details-content {
                margin: 10px;
                max-height: 95vh;
            }

            .teams-container {
                grid-template-columns: 1fr;
            }

            .team-section.blue-team {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }

            .player-row {
                grid-template-columns: 32px 1fr auto auto;
                font-size: 12px;
            }

            .player-champion {
                width: 32px;
                height: 32px;
            }

            .player-damage {
                display: none;
            }
        }

        main {
            max-width: 1250px;
            margin: 0 auto;
            padding: 90px 30px 120px;
        }

        .hero {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 50px;
            align-items: center;
            margin-bottom: 90px;
        }

        .hero-text h1 {
            font-size: clamp(2.4rem, 5vw, 3.8rem);
            line-height: 1.1;
            text-transform: uppercase;
        }

        .hero-text h1 span {
            background: linear-gradient(120deg, var(--accent), var(--accent-strong), var(--accent));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            animation: shimmer 4s linear infinite;
            background-size: 200% auto;
        }

        @keyframes shimmer {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }



        .hero-text-box {
            margin: 28px 0 42px;
            padding: 24px;
            border-radius: 16px;
            border: 1px solid var(--border-strong);
            background: var(--bg-card-dark);
            max-width: 540px;
            position: relative;
            overflow: hidden;
        }

        .hero-text-box::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--accent-soft), transparent 80%);
            pointer-events: none;
        }

        .hero-text-box p {
            font-size: 1.1rem;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }
        .accent-text { 
            background: linear-gradient(120deg, var(--accent), var(--accent-strong));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
        }

        .search-card {
            background: rgba(11, 22, 34, 0.78);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 32px;
            border-radius: 22px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .search-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top right, rgba(255, 210, 0, 0.12), transparent 45%);
            pointer-events: none;
        }

        .search-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 22px;
        }

        .search-header h3 {
            font-size: 1.1rem;
            letter-spacing: 1px;
        }

        .search-wrapper {
            display: flex;
            gap: 12px;
            align-items: stretch;
        }

        .name-tagline-wrapper {
            display: flex;
            flex: 1;
            border: 1px solid rgba(255, 255, 255, 0.16);
            border-radius: 999px;
            background: rgba(13, 25, 38, 0.85);
            transition: border-color 0.25s, box-shadow 0.25s;
            overflow: hidden;
            position: relative;
        }

        .name-tagline-wrapper:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 25px rgba(255, 210, 0, 0.2);
        }

        .name-input {
            flex: 2;
            min-width: 0;
            max-width: none;
            width: 100%;
            border: none;
            background: transparent;
            color: var(--text-main);
            padding: 16px 22px;
            font-family: inherit;
            font-size: 1rem;
            outline: none;
            overflow: visible;
            text-overflow: clip;
        }

        .tagline-input {
            flex: 1;
            min-width: 0;
            max-width: 140px;
            width: 100%;
            border: none;
            border-left: 1px solid rgba(255, 255, 255, 0.12);
            background: transparent;
            color: var(--text-main);
            padding: 16px 18px;
            font-family: inherit;
            font-size: 1rem;
            outline: none;
            overflow: visible;
            text-overflow: clip;
        }

        .name-input::placeholder,
        .tagline-input::placeholder {
            color: rgba(183, 177, 165, 0.7);
        }

        .region-select,
        .search-input {
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: rgba(13, 25, 38, 0.85);
            color: var(--text-main);
            padding: 16px 22px;
            font-family: inherit;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.25s, box-shadow 0.25s;
        }

        .region-select {
            min-width: 120px;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            padding-right: 28px; /* make room for chevron */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffd200' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center; /* closer to server name */
            background-size: 14px;
        }

        .search-input {
            flex: 1;
        }

        .region-select:focus,
        .search-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 25px rgba(255, 210, 0, 0.2);
        }

        .search-btn {
            border-radius: 999px;
            border: none;
            padding: 16px 26px;
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: #0b1524;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 18px 28px rgba(255, 210, 0, 0.4);
        }

        .search-footer {
            margin-top: 16px;
            font-size: 0.85rem;
            color: var(--text-soft);
        }

        section {
            margin-bottom: 90px;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 32px;
        }

        .section-header h2 {
            font-size: 2rem;
            text-transform: uppercase;
        }

        .section-header span {
            border-radius: 999px;
            padding: 9px 22px;
            background: rgba(255, 210, 0, 0.12);
            color: var(--accent);
            font-weight: 600;
            letter-spacing: 1px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 26px;
        }

        .card {
            background: var(--bg-card-dark);
            border-radius: 18px;
            padding: 24px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(150deg, rgba(255, 210, 0, 0.18), transparent 60%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .card:hover::before {
            opacity: 1;
        }

        .profile-summary {
            display: grid;
            grid-template-columns: minmax(600px, 1fr) minmax(400px, 1fr);
            gap: 32px;
        }

        .profile-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid var(--border);
            position: relative;
            overflow: visible;
            height: fit-content;
            align-self: start;
            box-sizing: border-box;
            width: 100%;
            max-width: 650px;
        }

        .banner-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            position: relative;
            overflow: visible;
            transition: none;
            box-shadow: none;
            min-height: auto;
            display: block;
            gap: 0;
            width: 100%;
        }

        .banner-box::before {
            display: none;
        }

        .banner-box:hover::before {
            display: none;
        }

        .banner-box:hover {
            transform: none;
            border-color: transparent;
            box-shadow: none;
        }

        .profile-content-box {
            background: linear-gradient(165deg, var(--bg-card-dark) 0%, rgba(16, 31, 48, 0.95) 100%);
            border: 1px solid var(--accent);
            border-top: none;
            border-radius: 0 0 14px 14px;
            padding: 22px;
            position: relative;
            overflow: visible;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(242, 204, 143, 0.05);
            box-sizing: border-box;
            width: 100%;
        }

        .profile-content-box::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--accent), 
                var(--accent-strong), 
                var(--accent), 
                var(--accent-strong));
            background-size: 200% 200%;
            border-radius: 2px 2px 16px 16px;
            z-index: -1;
            opacity: 0;
            animation: gradientShift 4s ease infinite;
            transition: opacity 0.3s ease;
        }

        .profile-content-box:hover::before {
            opacity: 0.3;
        }

        .profile-content-box:hover {
            transform: translateY(-2px);
            border-color: var(--accent-strong);
            box-shadow: 0 0 30px rgba(242, 204, 143, 0.1);
        }

        .profile-content-box::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--accent), 
                var(--accent-strong), 
                var(--accent), 
                var(--accent-strong));
            background-size: 200% 200%;
            border-radius: 14px;
            z-index: -1;
            opacity: 0;
            animation: gradientShift 4s ease infinite;
            transition: opacity 0.3s ease;
        }

        .profile-content-box:hover::before {
            opacity: 0.3;
        }

        .profile-content-box:hover {
            transform: translateY(-2px);
            border-color: var(--accent-strong);
            box-shadow: 0 0 30px rgba(242, 204, 143, 0.1);
        }

        /* Override enhanced effects for right side stat boxes */
        .enhanced-stats .stat-box {
            background: rgba(16, 31, 48, 0.3);
            border: 1px solid rgba(242, 204, 143, 0.1);
            box-shadow: none;
        }

        .enhanced-stats .stat-box::before {
            display: none;
        }

        .enhanced-stats .stat-box:hover {
            transform: none;
            border-color: rgba(242, 204, 143, 0.2);
            box-shadow: 0 0 10px rgba(242, 204, 143, 0.05);
        }

        .enhanced-stats .stat-box:hover::before {
            display: none;
        }

        .enhanced-stats .stat-box:hover .stat-icon {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(242, 204, 143, 0.2);
        }

        /* Add colored progress bars for right side enhanced stats */
        .enhanced-stats .performance-fill {
            background: linear-gradient(90deg, #22c55e, #16a34a);
        }

        .enhanced-stats .combat-fill {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }

        .enhanced-stats .economy-fill {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }

        .enhanced-stats .impact-fill {
            background: linear-gradient(90deg, #8b5cf6, #7c3aed);
        }

        .enhanced-stats .comparison-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }

        .enhanced-stats .comparison-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* Ensure proper spacing for left side stat boxes */
        .profile-content-box .stat-box {
            padding: 20px;
            min-height: 160px;
            font-size: 0.95rem;
            overflow: visible;
            box-sizing: border-box;
            width: 100%;
        }

        .profile-content-box .stat-comparison {
            margin-top: 14px;
            width: 100%;
            padding-bottom: 8px;
        }

        .profile-content-box .comparison-bar {
            width: calc(100% - 4px);
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 10px 2px;
            overflow: hidden;
            position: relative;
        }

        .profile-content-box .comparison-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
            position: relative;
        }

        .profile-content-box .comparison-labels,
        .profile-content-box .rank-change {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin: 6px 0;
            padding: 0 2px;
        }

        .profile-content-box .comparison-labels span,
        .profile-content-box .rank-change span {
            display: block;
            flex: 1;
            white-space: nowrap;
        }

        .profile-content-box .rank-change span:last-child,
        .profile-content-box .comparison-labels span:last-child {
            text-align: right;
        }

        .soon-badge { 
            background: var(--accent-soft);
            color: var(--accent);
            border: 1px solid var(--accent);
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 0.75rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 12px;
            position: relative;
            z-index: 2;
            box-shadow: 0 0 15px rgba(242, 204, 143, 0.1);
        }
        /* Profile banner (clickable video) */
        .profile-banner { 
            position: relative; 
            width: 100%;
            height: 200px; 
            border-radius: 14px 14px 0 0; /* Updated to only round top corners */
            background: var(--bg-card-dark);
            border: 1px solid var(--accent); 
            border-bottom: none; /* Remove bottom border */
            cursor: pointer; 
            display: grid; 
            place-items: center; 
            color: var(--text-soft); 
            overflow: hidden;
            transition: all 0.3s ease;
            box-sizing: border-box;
            box-shadow: 0 0 20px rgba(242, 204, 143, 0.05);
        }

        .profile-banner::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--accent), 
                var(--accent-strong), 
                var(--accent), 
                var(--accent-strong));
            background-size: 200% 200%;
            border-radius: 16px 16px 2px 2px;
            z-index: -1;
            opacity: 0;
            animation: gradientShift 4s ease infinite;
            transition: opacity 0.3s ease;
        }

        .profile-banner:hover::before {
            opacity: 0.3;
        }

        .profile-banner:hover {
            transform: translateY(-2px);
            border-color: var(--accent-strong);
            box-shadow: 0 0 30px rgba(242, 204, 143, 0.1);
        }

        .profile-banner video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 13px 13px 0 0; /* Slightly smaller than container to avoid border overflow */
            z-index: 1;
        }

        .profile-banner .play-pill,
        .profile-banner .banner-actions {
            position: relative;
            z-index: 2;
        }

        .profile-banner:hover {
            border-color: var(--border-strong);
        }

        .empty-banner-state {
            text-align: center;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .banner-actions { 
            position: absolute; 
            top: 12px; 
            right: 12px; 
            display: flex; 
            gap: 8px;
            z-index: 2;
        }

        .banner-upload {
            position: absolute;
            bottom: 12px;
            left: 12px;
            z-index: 2;
        }

        .has-video {
            background: linear-gradient(135deg, var(--accent-soft), var(--bg-card-dark));
        }
        .btn-mini { padding:6px 8px; border-radius:8px; border:1px solid rgba(255,255,255,.15); background: rgba(8,15,25,.6); color: var(--text-main); font-weight:700; font-size:.8rem; cursor:pointer; }
        .profile-banner .play-pill { background: rgba(255,210,0,0.18); color: var(--accent); border: 1px solid rgba(255,210,0,0.35); padding: 8px 12px; border-radius: 999px; font-weight: 700; letter-spacing: .5px; }

        .avatar.avatar-lg {
            width: 96px;
            height: 96px;
            border-width: 4px;
        }

        .profile-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top, rgba(255, 210, 0, 0.16), transparent 60%);
        }

        .profile-meta {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .avatar {
            width: 86px;
            height: 86px;
            border-radius: 50%;
            border: 3px solid rgba(255, 210, 0, 0.6);
            background: url('https://ddragon.leagueoflegends.com/cdn/14.15.1/img/profileicon/4569.png') center/cover;
        }

        .rank-pill {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 210, 0, 0.12);
            color: var(--accent);
            border-radius: 999px;
            padding: 8px 16px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-auto-rows: 1fr;
            gap: 16px;
            height: 100%;
            margin-top: -8px;
        }

        .stat-box {
            background: linear-gradient(165deg, var(--bg-card-dark) 0%, rgba(16, 31, 48, 0.95) 100%);
            border: 1px solid var(--accent);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(242, 204, 143, 0.05);
        }
        
        .stat-box:hover {
            transform: translateY(-2px);
            border-color: var(--accent-strong);
            box-shadow: 0 0 30px rgba(242, 204, 143, 0.1);
        }

        .stat-box::after {
            content: '';
            position: absolute;
            inset: 0;
            background-position: center;
            background-repeat: no-repeat;
            background-size: 180px;
            opacity: 0.03;
            z-index: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .stat-box:hover::after {
            opacity: 0.06;
        }
        
        .stat-box.wins::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23F2CC8F'%3E%3Cpath d='M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z'/%3E%3C/svg%3E");
        }

        .stat-box.kda::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23F2CC8F'%3E%3Cpath d='M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z'/%3E%3C/svg%3E");
        }

        .stat-box.damage::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23F2CC8F'%3E%3Cpath d='M14 9l-1-2H7V5.72c.6-.34 1-.98 1-1.72 0-1.1-.9-2-2-2s-2 .9-2 2c0 .74.4 1.38 1 1.72V21h2v-4h5l1-2h7V9h-6zm4 8h-4l-1 2H7V9h5l1 2h5v6z'/%3E%3C/svg%3E");
        }

        .stat-box.vision::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23F2CC8F'%3E%3Cpath d='M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z'/%3E%3C/svg%3E");
        }

        /* Enhanced 4-box stat icons */
        .stat-icon {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .performance-icon {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(59, 130, 246, 0.2));
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
        }

        .performance-icon::before {
            content: '⭐';
            font-size: 18px;
            line-height: 1;
            filter: drop-shadow(0 0 8px rgba(34, 197, 94, 0.5));
        }

        .combat-icon {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(245, 101, 101, 0.2));
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }

        .combat-icon::before {
            content: '⚔️';
            font-size: 18px;
            line-height: 1;
            filter: drop-shadow(0 0 8px rgba(239, 68, 68, 0.5));
        }

        .economy-icon {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        .economy-icon::before {
            content: '💰';
            font-size: 18px;
            line-height: 1;
            filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.5));
        }

        .impact-icon {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(147, 51, 234, 0.2));
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
        }

        .impact-icon::before {
            content: '💥';
            font-size: 18px;
            line-height: 1;
            filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.5));
        }

        /* Stat box hover effects for icons */
        .stat-box:hover .stat-icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 0 30px rgba(242, 204, 143, 0.4);
        }

        /* Custom progress bar colors */
        .performance-fill {
            background: linear-gradient(90deg, #22c55e 0%, #3b82f6 100%);
        }

        .combat-fill {
            background: linear-gradient(90deg, #ef4444 0%, #f56565 100%);
        }

        .economy-fill {
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
        }

        .impact-fill {
            background: linear-gradient(90deg, #a855f7 0%, #9333ea 100%);
        }

        .enhanced-stats {
            grid-template-columns: 1fr;
            gap: 20px;
            width: 100%;
            max-width: 500px;
        }

        @media (max-width: 1200px) {
            .profile-summary {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .profile-card {
                max-width: none;
            }
        }

        @media (max-width: 768px) {
            .enhanced-stats {
                grid-template-columns: 1fr;
                gap: 16px;
                max-width: none;
            }
        }

        /* Enhanced stat box animations and effects */
        .stat-box {
            position: relative;
            overflow: hidden;
        }

        .stat-box::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--accent), 
                var(--accent-strong), 
                var(--accent), 
                var(--accent-strong));
            background-size: 200% 200%;
            border-radius: 14px;
            z-index: -1;
            opacity: 0;
            animation: gradientShift 4s ease infinite;
            transition: opacity 0.3s ease;
        }

        .stat-box:hover::before {
            opacity: 0.3;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Stat value number animation */
        .stat-value {
            position: relative;
            overflow: hidden;
        }

        .stat-value::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent);
            animation: valueShine 3s infinite;
        }

        @keyframes valueShine {
            0% { left: -100%; }
            50% { left: -100%; }
            100% { left: 100%; }
        }

        .stat-box::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(120deg, var(--accent-soft), transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }
        
        .stat-box:hover::before {
            opacity: 1;
        }

        .stat-comparison {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 4px;
        }

        .comparison-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }

        .comparison-fill {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--accent) 0%, var(--accent-strong) 100%);
            border-radius: 2px;
            transition: width 1s ease-out;
        }

        .comparison-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-soft);
        }

        .comparison-rank {
            color: var(--accent);
            font-weight: 600;
        }

        .rank-change {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 4px;
            font-size: 0.75rem;
            color: #4ade80;
        }

        .rank-change.negative {
            color: #ef4444;
        }

        .rank-change span:first-child {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .rank-change span:first-child::before {
            content: '▲';
            font-size: 0.7rem;
        }

        .rank-change.negative span:first-child::before {
            content: '▼';
        }

        .stat-calculation {
            text-align: center;
            margin-top: 16px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .calc-title {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 6px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .calc-formula {
            font-size: 0.75rem;
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 8px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .calc-details {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .stat-box > div {
            position: relative;
            z-index: 2;
        }

        .comparison-fill {
            position: relative;
            overflow: hidden;
        }

        .comparison-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent 100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        .stat-label {
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 1.5px;
            color: var(--accent);
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            margin: 4px 0;
            background: linear-gradient(120deg, var(--text-main), var(--accent-strong));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            z-index: 1;
        }

        .stat-subtext {
            font-size: 0.8rem;
            color: var(--text-muted);
            position: relative;
            z-index: 1;
        }

        .tab-group {
            display: inline-flex;
            border-radius: 999px;
            background: rgba(11, 22, 36, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.05);
            overflow: hidden;
            margin-bottom: 22px;
        }

        .tab-group button {
            border: none;
            background: transparent;
            color: var(--text-muted);
            padding: 10px 24px;
            font-weight: 600;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .tab-group button.active {
            background: linear-gradient(135deg, rgba(255, 210, 0, 0.18), rgba(255, 210, 0, 0.35));
            color: var(--text-main);
        }

        .match-list {
            display: grid;
            gap: 20px;
        }

        .match-card {
            display: grid;
            grid-template-columns: minmax(180px, 1.3fr) minmax(130px, 1fr) minmax(150px, 1fr) 90px;
            gap: 20px;
            align-items: center;
            background: rgba(8, 15, 25, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 18px;
            padding: 18px 22px;
            transition: transform 0.2s;
        }

        .match-card[style*="cursor: pointer"]:hover {
            background: rgba(8, 15, 25, 0.95);
            border-color: var(--accent-soft);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(242, 204, 143, 0.15);
        }

        .match-card:hover {
            transform: translateY(-3px);
        }

        .match-meta {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .champ-icon {
            width: 54px;
            height: 54px;
            border-radius: 14px;
            background-size: cover;
            background-position: center;
            border: 2px solid rgba(255, 255, 255, 0.12);
        }

        .match-result {
            font-weight: 700;
        }

        .match-result.win {
            color: #56f39a;
        }

        .match-result.loss {
            color: #f76d6d;
        }

        .match-stats strong {
            font-size: 1.2rem;
        }

        .match-time {
            font-size: 0.85rem;
            color: var(--text-soft);
        }

        .champ-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
        }

        .champ-card {
            background: var(--bg-card-dark);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 24px;
            display: grid;
            gap: 14px;
            position: relative;
            overflow: visible;
            transition: transform 0.2s, border-color 0.2s;
        }

        .champ-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: var(--champ-splash);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.4;
            transition: opacity 0.3s;
            z-index: 0;
            border-radius: 17px;
        }



        .champ-card:hover {
            transform: translateY(-2px);
            border-color: var(--border-strong);
        }

        .champ-card:hover::before {
            opacity: 0.25;
        }

        .champ-card > * {
            position: relative;
            z-index: 2;
        }

        .champ-card .champ-overlay {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                135deg,
                rgba(27, 45, 58, 0.9) 0%,
                rgba(27, 45, 58, 0.7) 40%,
                rgba(27, 45, 58, 0.3) 70%,
                transparent 100%
            );
            z-index: 1;
            border-radius: 17px;
            pointer-events: none;
        }

        .champ-role {
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--accent);
            margin-bottom: -4px;
        }

        .champ-name {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            color: white;
            margin-bottom: 4px;
        }

        .champ-alias {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .champ-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.75);
            border-radius: 12px;
            padding: 16px;
            backdrop-filter: blur(10px);
            margin-top: auto;
            gap: 16px;
        }

        .champ-meta span {
            font-weight: 700;
        }

        .leaderboard {
            background: var(--bg-card-dark);
            border-radius: 22px;
            border: 1px solid var(--border);
            overflow: hidden;
            position: relative;
        }

        .leaderboard table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard thead {
            background: var(--bg-darker);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
            position: sticky;
            top: 0;
            z-index: 2;
        }

        .leaderboard th,
        .leaderboard td {
            padding: 18px 24px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .leaderboard tbody tr {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .leaderboard tbody tr:hover {
            background: var(--accent-soft);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .leaderboard-region-select {
            position: absolute;
            top: 16px;
            right: 16px;
            z-index: 3;
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 120px;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23F2CC8F' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 16px;
            padding-right: 32px;
        }

        .leaderboard-region-select:hover,
        .leaderboard-region-select:focus {
            border-color: var(--accent);
            background-color: var(--bg-darker);
            box-shadow: 0 0 0 1px var(--accent-soft);
        }

        .rank-number {
            font-weight: 700;
            color: var(--accent);
        }

        .community-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 26px;
        }

        .community-card {
            background: rgba(12, 24, 38, 0.85);
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-height: 220px;
        }

        .community-card h3 {
            font-size: 1.2rem;
        }

        .community-card p {
            color: var(--text-muted);
            line-height: 1.5;
        }

        /* Coming soon cards */
        .coming-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 22px; }
        .coming-card {
            background: var(--bg-card-dark);
            border: 1px solid var(--accent);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            transition: transform 0.3s, border-color 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(242, 204, 143, 0.05);
        }
        .coming-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-strong);
            box-shadow: 0 0 25px rgba(242, 204, 143, 0.1);
        }
        .coming-card h3 { 
            margin-bottom: 4px;
            font-size: 1.2rem;
            position: relative;
            z-index: 2;
        }
        .coming-card p { 
            color: var(--text-muted);
            line-height: 1.5;
            position: relative;
            z-index: 2;
        }

        /* Heatmap placeholder */
        .heatmap {
            background: radial-gradient(circle at 40% 40%, rgba(255, 78, 80, .35), transparent 40%),
                        radial-gradient(circle at 60% 60%, rgba(246, 187, 67, .35), transparent 45%),
                        radial-gradient(circle at 50% 70%, rgba(86, 243, 154, .25), transparent 45%),
                        rgba(8,15,25,.7);
            height: 120px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,.08);
        }

        /* Chatbox (coming soon) */
        .chat-fab {
            position: fixed;
            right: 22px;
            bottom: 22px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 0;
            cursor: pointer;
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: #0b1524;
            font-weight: 800;
            box-shadow: 0 12px 28px rgba(255,210,0,.35);
            z-index: 200;
        }
        .chat-panel {
            position: fixed;
            right: 22px;
            bottom: 90px;
            width: min(360px, calc(100% - 44px));
            background: rgba(8,15,25,.92);
            border: 1px solid rgba(255,255,255,.08);
            border-radius: 14px;
            box-shadow: var(--shadow);
            display: none;
            overflow: hidden;
            z-index: 200;
        }
        .chat-header { padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,.08); display:flex; align-items:center; justify-content:space-between; }
        .chat-body { padding: 14px; height: 220px; overflow: auto; color: var(--text-soft); }
        .chat-input { display: flex; gap: 8px; padding: 12px; border-top: 1px solid rgba(255,255,255,.08); }
        .chat-input input { flex: 1; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,.12); background: rgba(13,25,38,.85); color: var(--text-main); }
        .chat-input button { padding: 10px 14px; border-radius: 10px; border: 0; background: rgba(255,210,0,.18); color: var(--accent); font-weight: 700; cursor: not-allowed; }

        .cta-banner {
            background: linear-gradient(120deg, rgba(255, 210, 0, 0.22), rgba(255, 210, 0, 0.08), rgba(13, 25, 42, 0.9));
            border-radius: 26px;
            border: 1px solid rgba(255, 210, 0, 0.35);
            padding: 50px;
            text-align: center;
            display: grid;
            gap: 18px;
        }

        .cta-banner h2 {
            font-size: clamp(2rem, 4vw, 2.6rem);
        }

        .cta-banner p {
            color: var(--text-muted);
            max-width: 520px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .cta-actions {
            display: flex;
            justify-content: center;
            gap: 18px;
            flex-wrap: wrap;
        }

        .btn-outline {
            padding: 14px 28px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            background: rgba(10, 20, 34, 0.6);
            color: var(--text-main);
            font-weight: 600;
            letter-spacing: 1px;
            cursor: pointer;
            transition: border-color 0.25s, color 0.25s;
        }

        .btn-outline:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        footer {
            background: #050a10;
            padding: 50px 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .footer-inner {
            max-width: 1250px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
        }

        .footer-col h4 {
            font-size: 1.05rem;
            margin-bottom: 18px;
            letter-spacing: 1px;
        }

        .footer-col ul {
            list-style: none;
            display: grid;
            gap: 10px;
        }

        .footer-col li {
            color: var(--text-soft);
            font-size: 0.95rem;
        }

        .footer-meta {
            margin-top: 40px;
            text-align: center;
            color: var(--text-soft);
            font-size: 0.85rem;
        }

        @media (max-width: 1200px) {
            main {
                padding: 70px 20px 120px;
            }

            .profile-summary {
                grid-template-columns: 1fr;
            }

            .hero {
                gap: 30px;
            }
        }

        @media (max-width: 900px) {
            nav {
                flex-direction: column;
                gap: 18px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                width: 100%;
            }

            main {
                padding-top: 60px;
            }

            .hero-text h1 {
                font-size: clamp(2rem, 4vw, 3rem);
            }

            .search-card {
                padding: 24px;
            }

            .cta-banner {
                padding: 40px 24px;
            }
        }

        @media (max-width: 768px) {
            :root {
                font-size: 15px;
            }

            nav {
                padding: 14px 16px;
            }

            .search-wrapper {
                flex-direction: column;
                gap: 10px;
            }

            .name-tagline-wrapper {
                flex-direction: column;
                border-radius: 16px;
            }

            .name-input {
                padding: 14px 18px;
                border-left: none;
                border-bottom: 1px solid rgba(255, 255, 255, 0.12);
                width: auto;
                max-width: none;
                flex: none;
            }

            .tagline-input {
                padding: 14px 18px;
                border-left: none;
                border-bottom: none;
                width: auto;
                max-width: none;
                flex: none;
            }

            .region-select,
            .search-input,
            .search-btn {
                width: 100%;
                padding: 14px 18px;
                font-size: 1rem;
            }

            .match-card {
                grid-template-columns: 1fr;
                gap: 14px;
                padding: 14px 16px;
                text-align: left;
            }

            .section-header {
                flex-direction: column;
                gap: 12px;
                align-items: flex-start;
            }

            .stat-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .champ-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 16px;
            }

            .community-grid {
                grid-template-columns: 1fr;
            }

            .footer-inner {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .cta-banner {
                padding: 32px 20px;
            }

            .cta-banner h2 {
                font-size: clamp(1.6rem, 3vw, 2.2rem);
            }
        }

        @media (max-width: 600px) {
            main {
                padding: 60px 16px 80px;
            }

            .hero-text h1 {
                font-size: 1.8rem;
                line-height: 1.2;
            }

            .hero-text-box {
                padding: 16px;
            }

            .search-card {
                padding: 16px;
                border-radius: 14px;
            }

            .search-header {
                flex-direction: column;
                gap: 12px;
                margin-bottom: 16px;
            }

            .profile-identity {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .avatar.avatar-lg {
                width: 80px;
                height: 80px;
                border-width: 3px;
                margin: 0 auto;
            }

            .stat-grid {
                gap: 12px;
            }

            .leaderboard table {
                font-size: 0.9rem;
            }

            .leaderboard th,
            .leaderboard td {
                padding: 12px 8px;
            }

            .coming-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .cta-actions {
                flex-direction: column;
                gap: 12px;
            }

            .cta-actions button {
                width: 100%;
            }

            .chat-panel {
                width: calc(100% - 20px);
                bottom: 70px;
                right: 10px;
                left: 10px;
            }

            .profile-banner {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">Yordlepedia</div>
            <div class="nav-links">
                <a href="#search">Search</a>
                <a href="#profile">Overview</a>
                <a href="#matches">Matches</a>
                <a href="#champions">Champions</a>
                <a href="#leaderboard">Leaderboard</a>
                <a href="#community">Community</a>
                <a href="#coming-soon">Coming Soon</a>
            </div>
            <div class="auth-container" id="authContainer">
                <div class="auth-status" id="authStatus">Not authenticated</div>
                <div class="auth-user-info" id="authUserInfo" style="display: none;">
                    <span id="authUsername">Username</span>
                    <span class="user-region" id="authRegion">Region</span>
                </div>
                <a href="/auth/riot" class="auth-btn" id="authSignIn">
                    <span>🎮</span> Sign In with Riot
                </a>
                <button class="auth-btn logout" id="authSignOut" style="display: none;" onclick="handleLogout()">
                    <span>🚪</span> Sign Out
                </button>
            </div>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-text">
                <h1>All Your <span>League Data</span> In One Place</h1>
                <div class="hero-text-box">
                    <p class="accent-text">Search any summoner worldwide, dive into in-depth analytics, and stay ahead of the meta with real-time insights engineered for climbers, creators, and coaching teams.</p>
                </div>
                <div class="cta-actions">
                    <button class="search-btn" onclick="handleDownload()">Download Desktop Companion</button>
                </div>
            </div>
            <article class="search-card" id="search">
                <div class="search-header">
                    <h3>Instant Summoner Lookup</h3>
                    <span class="rank-pill">Live Stats</span>
                </div>
                <div class="search-wrapper">
                    <select id="regionSelect" class="region-select">
                        <option value="na1">NA</option>
                        <option value="euw1">EUW</option>
                        <option value="eun1">EUNE</option>
                        <option value="kr">KR</option>
                        <option value="br1">BR</option>
                        <option value="jp1">JP</option>
                        <option value="ru">RU</option>
                        <option value="oc1">OCE</option>
                        <option value="tr1">TR</option>
                        <option value="la1">LAN</option>
                        <option value="la2">LAS</option>
                        <option value="ph2">PH</option>
                        <option value="sg2">SG</option>
                        <option value="th2">TH</option>
                        <option value="tw2">TW</option>
                        <option value="vn2">VN</option>
                    </select>
                    <div class="name-tagline-wrapper">
                        <input id="summonerName" class="search-input name-input" type="search" placeholder="Enter summoner name (e.g. Faker)">
                        <input id="summonerTagline" class="search-input tagline-input" type="search" placeholder="(E.G. #000)">
                    </div>
                    <button class="search-btn" onclick="handleSearch()">Search</button>
                </div>
                <p class="search-footer">Example: Enter summoner name and tagline to search any player profile.</p>
            </article>
        </section>

        <section id="profile">
            <div class="section-header">
                <h2>Profile Spotlight</h2>
                <span id="profileHeadline">Gold II · 52.3% Winrate</span>
            </div>
            <div class="profile-summary">
                <aside class="profile-card" style="display: flex; flex-direction: column; gap: 0;">
                    <!-- Banner Box - Full Width -->
                    <div class="banner-box" style="width: 100%;">
                        <div class="profile-banner" onclick="openHighlight()" id="profileBanner">
                            <div class="empty-banner-state">
                                <p style="font-size:1.1rem; margin-bottom:8px;">No Highlight Video Set</p>
                                <p style="font-size:0.9rem; color:var(--text-muted);">Upload a video or set URL to showcase your best plays</p>
                            </div>
                            <div class="banner-actions" onclick="event.stopPropagation()">
                                <button class="btn-mini" onclick="setBannerClip()">Set URL</button>
                                <button class="btn-mini" onclick="document.getElementById('uploadVideo').click()">Upload</button>
                            </div>
                            <input type="file" id="uploadVideo" accept="video/*" style="display:none" onchange="handleVideoUpload(event)">
                        </div>
                    </div>

                    <!-- Profile Info & Stats Box -->
                    <div class="profile-content-box" style="width: 100%; display: flex; flex-direction: column; gap: 18px; padding-bottom: 24px;">
                        <div class="profile-identity" style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                            <div class="avatar avatar-lg" aria-hidden="true"></div>
                            <div style="flex: 1; min-width: 0;">
                                <h3 id="profileName" style="margin: 0 0 4px 0;">SummonerName</h3>
                                <p class="stat-subtext" id="profileMeta" style="margin: 0 0 6px 0;">NA · Level 218 · Top 3.2%</p>
                            </div>
                        </div>

                        <div class="stat-grid" style="display: grid; grid-template-columns: 1fr; gap: 16px; overflow: visible; padding: 4px;">
                            <div class="stat-box wins">
                                <h4 style="font-size: 1.1rem; margin: 0 0 8px 0; color: var(--text-primary);">Win Rate</h4>
                                <div id="statWinRateValue" style="font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; color: var(--accent);">52.3%</div>
                                <div class="stat-comparison">
                                    <div class="comparison-bar">
                                        <div id="statWinRateFill" class="comparison-fill" style="width: 65%; background: linear-gradient(90deg, #22c55e, #16a34a);"></div>
                                    </div>
                                    <div class="comparison-labels" style="font-size: 0.85rem;">
                                        <span id="statWinRateAvg">Average: 49.8%</span>
                                        <span class="comparison-rank" id="statWinRateRank">Top 35%</span>
                                    </div>
                                    <div class="rank-change" style="font-size: 0.85rem;">
                                        <span id="statWinRateChange" style="color: #22c55e;">+2.1%</span>
                                        <span>Last 30 days</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box kda">
                                <h4 style="font-size: 1.1rem; margin: 0 0 8px 0; color: var(--text-primary);">KDA Ratio</h4>
                                <div id="statKDAValue" style="font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; color: var(--accent);">3.42</div>
                                <div class="stat-comparison">
                                    <div class="comparison-bar">
                                        <div id="statKDAFill" class="comparison-fill" style="width: 78%; background: linear-gradient(90deg, #3b82f6, #1d4ed8);"></div>
                                    </div>
                                    <div class="comparison-labels" style="font-size: 0.85rem;">
                                        <span id="statKDAAvg">Average: 2.89</span>
                                        <span class="comparison-rank" id="statKDARank">Top 22%</span>
                                    </div>
                                    <div class="rank-change" style="font-size: 0.85rem;">
                                        <span id="statKDAChange" style="color: #22c55e;">+0.31</span>
                                        <span>Last 30 days</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box damage">
                                <h4 style="font-size: 1.1rem; margin: 0 0 8px 0; color: var(--text-primary);">Avg Damage</h4>
                                <div id="statDamageValue" style="font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; color: var(--accent);">24.8K</div>
                                <div class="stat-comparison">
                                    <div class="comparison-bar">
                                        <div id="statDamageFill" class="comparison-fill" style="width: 72%; background: linear-gradient(90deg, #f59e0b, #d97706);"></div>
                                    </div>
                                    <div class="comparison-labels" style="font-size: 0.85rem;">
                                        <span id="statDamageAvg">Average: 21.2K</span>
                                        <span class="comparison-rank" id="statDamageRank">Top 28%</span>
                                    </div>
                                    <div class="rank-change negative" style="font-size: 0.85rem;">
                                        <span id="statDamageChange" style="color: #ef4444;">-1.2K</span>
                                        <span>Last 30 days</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-box vision">
                                <h4 style="font-size: 1.1rem; margin: 0 0 8px 0; color: var(--text-primary);">Vision Score</h4>
                                <div id="statVisionValue" style="font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; color: var(--accent);">42.6</div>
                                <div class="stat-comparison">
                                    <div class="comparison-bar">
                                        <div id="statVisionFill" class="comparison-fill" style="width: 85%; background: linear-gradient(90deg, #8b5cf6, #7c3aed);"></div>
                                    </div>
                                    <div class="comparison-labels" style="font-size: 0.85rem;">
                                        <span id="statVisionAvg">Average: 35.4</span>
                                        <span class="comparison-rank" id="statVisionRank">Top 15%</span>
                                    </div>
                                    <div class="rank-change" style="font-size: 0.85rem;">
                                        <span id="statVisionChange" style="color: #22c55e;">+3.2</span>
                                        <span>Last 30 days</span>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </aside>
                <div class="stat-grid enhanced-stats">
                    <div class="stat-box performance-overview">
                        <div class="stat-icon performance-icon"></div>
                        <div style="position: relative; z-index: 2;">
                            <div class="stat-label">Performance Score</div>
                            <div class="stat-value" id="statPerformanceValue">8.4</div>
                            <div class="stat-subtext" id="statPerformanceSubtext">
                                <span style="color: #4ade80">64% WR</span> • 
                                <span style="color: #60a5fa">214 Wins</span> • 
                                <span style="color: #fbbf24">32% Perfect KDA</span>
                            </div>
                        </div>
                        <div class="stat-comparison">
                            <div class="comparison-bar">
                                <div class="comparison-fill performance-fill" style="width: 84%"></div>
                            </div>
                            <div class="comparison-labels">
                                <span>Top 16%</span>
                                <span class="comparison-rank">Overall Ranking</span>
                            </div>
                            <div class="rank-change">
                                <span>Excellent Season</span>
                                <span style="color: var(--text-soft)">• 6 First Bloods</span>
                            </div>
                        </div>
                        <div class="stat-calculation">
                            <div class="calc-title">📊 Calculation:</div>
                            <div class="calc-formula">Win Rate (40%) + KDA Ratio (35%) + Consistency (25%)</div>
                            <div class="calc-details">
                                • <strong>Win Rate:</strong> Your ranked win percentage<br>
                                • <strong>KDA Ratio:</strong> (Kills + Assists) ÷ Deaths<br>
                                • <strong>Consistency:</strong> Perfect KDA games & kill participation
                            </div>
                        </div>
                    </div>

                    <div class="stat-box combat-mastery">
                        <div class="stat-icon combat-icon"></div>
                        <div style="position: relative; z-index: 2;">
                            <div class="stat-label">Combat Mastery</div>
                            <div class="stat-value" id="statCombatValue">3.68</div>
                            <div class="stat-subtext" id="statCombatSubtext">
                                <span style="color: #4ade80">6.2</span> / 
                                <span style="color: #ef4444">1.7</span> / 
                                <span style="color: #60a5fa">5.8</span> • 
                                <span style="color: #f59e0b">15 Multikills</span>
                            </div>
                        </div>
                        <div class="stat-comparison">
                            <div class="comparison-bar">
                                <div class="comparison-fill combat-fill" style="width: 86%"></div>
                            </div>
                            <div class="comparison-labels">
                                <span>Top 14%</span>
                                <span class="comparison-rank">KDA Efficiency</span>
                            </div>
                            <div class="rank-change">
                                <span>Elite Fighter</span>
                                <span style="color: var(--text-soft)">• 1 Pentakill</span>
                            </div>
                        </div>
                        <div class="stat-calculation">
                            <div class="calc-title">⚔️ Calculation:</div>
                            <div class="calc-formula">KDA Ratio + Multikill Bonus + Combat Achievements</div>
                            <div class="calc-details">
                                • <strong>KDA Ratio:</strong> (Kills + Assists) ÷ Deaths<br>
                                • <strong>Multikills:</strong> Double, Triple, Quadra, Pentakills<br>
                                • <strong>Combat Skills:</strong> First bloods & solo kills
                            </div>
                        </div>
                    </div>

                    <div class="stat-box economy-control">
                        <div class="stat-icon economy-icon"></div>
                        <div style="position: relative; z-index: 2;">
                            <div class="stat-label">Economy Control</div>
                            <div class="stat-value" id="statEconomyValue">7.8</div>
                            <div class="stat-subtext" id="statEconomySubtext">
                                <span style="color: #fbbf24">CS/min</span> • 
                                <span style="color: #4ade80">13.5K Gold</span> • 
                                <span style="color: #60a5fa">156 CS/game</span>
                            </div>
                        </div>
                        <div class="stat-comparison">
                            <div class="comparison-bar">
                                <div class="comparison-fill economy-fill" style="width: 82%"></div>
                            </div>
                            <div class="comparison-labels">
                                <span>Top 18%</span>
                                <span class="comparison-rank">Farming Efficiency</span>
                            </div>
                            <div class="rank-change">
                                <span>Strong Farmer</span>
                                <span style="color: var(--text-soft)">• 28min avg game</span>
                            </div>
                        </div>
                        <div class="stat-calculation">
                            <div class="calc-title">💰 Calculation:</div>
                            <div class="calc-formula">CS Efficiency + Gold Generation + Farm Advantage</div>
                            <div class="calc-details">
                                • <strong>CS per Minute:</strong> Minions + jungle monsters farmed<br>
                                • <strong>Gold per Game:</strong> Total gold earned average<br>
                                • <strong>Farm Lead:</strong> CS advantage over role average
                            </div>
                        </div>
                    </div>

                    <div class="stat-box impact-rating">
                        <div class="stat-icon impact-icon"></div>
                        <div style="position: relative; z-index: 2;">
                            <div class="stat-label">Team Impact</div>
                            <div class="stat-value" id="statImpactValue">29%</div>
                            <div class="stat-subtext" id="statImpactSubtext">
                                <span style="color: #ef4444">24.8K Damage</span> • 
                                <span style="color: #60a5fa">32 Vision</span> • 
                                <span style="color: #4ade80">72% KP</span>
                            </div>
                        </div>
                        <div class="stat-comparison">
                            <div class="comparison-bar">
                                <div class="comparison-fill impact-fill" style="width: 88%"></div>
                            </div>
                            <div class="comparison-labels">
                                <span>Top 12%</span>
                                <span class="comparison-rank">Team Contribution</span>
                            </div>
                            <div class="rank-change">
                                <span>High Impact</span>
                                <span style="color: var(--text-soft)">• Damage Share</span>
                            </div>
                        </div>
                        <div class="stat-calculation">
                            <div class="calc-title">🤝 Calculation:</div>
                            <div class="calc-formula">Damage Share (40%) + Kill Participation (35%) + Vision Score (25%)</div>
                            <div class="calc-details">
                                • <strong>Damage Share:</strong> % of team's total damage to champions<br>
                                • <strong>Kill Participation:</strong> (Kills + Assists) / Team Kills<br>
                                • <strong>Vision Score:</strong> Wards placed, cleared, and objective control
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="matches">
            <div class="section-header">
                <h2>Recent Match History</h2>
                <span>Updated a few minutes ago</span>
            </div>
            <div class="tab-group">
                <button class="active" data-queue="RANKED_SOLO">Ranked Solo</button>
                <button data-queue="RANKED_FLEX">Ranked Flex</button>
                <button data-queue="ARAM">ARAM</button>
            </div>
            <div class="match-list" id="matchList"></div>
        </section>

        <section id="champions">
            <div class="section-header">
                <h2>Champion Performance</h2>
                <span>Season 14 · Patch 14.15</span>
            </div>
            <div class="champ-grid" id="champGrid"></div>
        </section>

        <section id="leaderboard">
            <div class="section-header">
                <h2>Regional Leaderboard</h2>
                <span>KR · Top 5 Summoners</span>
            </div>
            <div class="leaderboard">
                <select id="leaderboardRegionSelect" class="leaderboard-region-select" onchange="updateLeaderboardRegion(this.value)">
                    <option value="kr" selected>KR</option>
                    <option value="na1">NA</option>
                    <option value="euw1">EUW</option>
                    <option value="eun1">EUNE</option>
                    <option value="br1">BR</option>
                    <option value="jp1">JP</option>
                    <option value="ru">RU</option>
                    <option value="oc1">OCE</option>
                    <option value="tr1">TR</option>
                    <option value="la1">LAN</option>
                    <option value="la2">LAS</option>
                </select>
                <table>
                    <thead>
                        <tr>
                            <th style="width:80px">Rank</th>
                            <th>Summoner</th>
                            <th style="width:100px">LP</th>
                            <th style="width:100px">Win Rate</th>
                            <th style="width:120px">Games</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody"></tbody>
                </table>
            </div>
        </section>

        <section id="community">
            <div class="section-header">
                <h2>Community & Insights</h2>
                <span>Stay ahead of the meta</span>
            </div>
            <div class="community-grid">
                <article class="community-card">
                    <h3>Meta Forecast</h3>
                    <p>Our analysts review 12 million games each patch to surface the strongest champions, builds, and rune paths per elo bracket.</p>
                    <button class="btn-outline" onclick="handleDownload()">Get The Desktop Overlay</button>
                </article>
                <article class="community-card">
                    <h3>Creator Hub</h3>
                    <p>Stream alerts, sharable stat cards, and highlight automation help creators turn every climb into content worth watching.</p>
                    <button class="btn-outline" onclick="handleLogin()">Join Creator Program</button>
                </article>
                <article class="community-card">
                    <h3>Coaching Toolkit</h3>
                    <p>Compare players role-by-role, review heatmaps, and analyze objective control timelines to pinpoint improvement areas.</p>
                    <button class="btn-outline" onclick="handleLogin()">Request Coach Access</button>
                </article>
            </div>
        </section>

        <section id="coming-soon">
            <div class="section-header">
                <h2>Coming Soon</h2>
                <span>Roadmap highlights</span>
            </div>

            <div class="coming-grid">
                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Profile Video Banner</h3>
                    <p>Choose any clip as your profile banner. Showcase your best plays right at the top of your page.</p>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Tier Lists by Role</h3>
                    <p>Data-driven tier lists for Top, Jungle, Mid, ADC, and Support with patch-by-patch trends.</p>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Desktop Overlay</h3>
                    <p>Downloadable app with in-game overlay for build tips, timers, and matchup notes.</p>
                    <div class="cta-actions" style="margin-top:10px">
                        <button class="btn-outline" onclick="handleDownload()">Get Overlay</button>
                    </div>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Social Comparison</h3>
                    <p>Compare stats with friends on the same champions and roles over chosen time windows.</p>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Pro/Streamer Benchmarks</h3>
                    <p>See how you stack up to pros and streamers. Side-by-side deltas on CS, vision, damage, and more.</p>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Mini Heatmaps</h3>
                    <div class="heatmap" style="margin-top:8px"></div>
                    <p style="margin-top:8px">Role- and champ-specific hot zones to improve pathing and positioning.</p>
                </article>

                <article class="coming-card">
                    <span class="soon-badge">Soon</span>
                    <h3>Integrated Chatbox</h3>
                    <p>Stay connected with teammates and friends directly on your profile and match pages.</p>
                </article>
            </div>
        </section>

        <section class="cta-banner">
            <h2>Ready To Level Up Your Rift Presence?</h2>
            <p>Install Yordlepedia Desktop for real-time draft recommendations, in-game overlays, and post-match breakdowns tailored to your champion pool.</p>
            <div class="cta-actions">
                <button class="search-btn" onclick="handleDownload()">Download For Windows</button>
                <button class="btn-outline" onclick="handleDownload()">Download For macOS</button>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-inner">
            <div class="footer-col">
                <h4>Yordlepedia.gg</h4>
                <p class="stat-subtext">Competitive analytics built for League of Legends players across every skill tier.</p>
            </div>
            <div class="footer-col">
                <h4>Product</h4>
                <ul>
                    <li>Summoner Search</li>
                    <li>Champion Insights</li>
                    <li>In-Game Overlay</li>
                    <li>Team Analytics</li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Resources</h4>
                <ul>
                    <li>Patch Notes Companion</li>
                    <li>Tier List Updates</li>
                    <li>API Documentation</li>
                    <li>Coaching Portal</li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Community</h4>
                <ul>
                    <li>Discord</li>
                    <li>Twitter</li>
                    <li>Reddit</li>
                    <li>Support</li>
                </ul>
            </div>
        </div>
        <div class="footer-meta">
            <p>&copy; 2025 Yordlepedia.gg &middot; MIT License</p>
            <p>Yordlepedia is not endorsed by Riot Games and does not reflect the views or opinions of Riot Games or any official partners.</p>
            <div style="margin-top: 12px; display: flex; gap: 20px; justify-content: center; font-size: 14px;">
                <a href="/privacy" style="color: var(--text-muted); text-decoration: none; transition: color 0.2s;">Privacy Policy</a>
                <a href="/tos" style="color: var(--text-muted); text-decoration: none; transition: color 0.2s;">Terms of Service</a>
            </div>
        </div>
    </footer>

    <!-- Profile highlight modal -->
    <div id="highlightModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.95); z-index:300; align-items:center; justify-content:center;">
        <div style="background: var(--bg-card); padding: 24px; border-radius: 16px; border: 1px solid var(--border); max-width:900px; width:90%; position:relative;">
            <button onclick="closeHighlight()" aria-label="Close" title="Close" class="close-btn"
                style="position:absolute; right:-16px; top:-16px; background: var(--bg-card-dark); color:var(--accent); 
                border:1px solid var(--border-strong); border-radius:50%; width:32px; height:32px; font-weight:700; 
                cursor:pointer; display:flex; align-items:center; justify-content:center; z-index:2; font-size:20px;">
                ×
            </button>
            <video id="highlightVideo" controls style="width:100%; border-radius:8px; background:var(--bg-darker);">
                Your browser does not support video playback.
            </video>
            <div style="display:flex; justify-content:flex-end; margin-top:8px">
                <button class="btn-outline" onclick="closeHighlight()">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Authentication Management
        let authState = {
            authenticated: false,
            user: null,
            tokenExpired: false
        };

        // Check authentication status on page load
        async function checkAuthStatus() {
            try {
                const response = await fetch('/auth/status');
                const data = await response.json();
                authState = data;
                updateAuthUI();
                
                // Handle URL params for auth success/error
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('auth') === 'success') {
                    showNotification('Successfully signed in with Riot!', 'success');
                    // Clean up URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            } catch (error) {
                console.error('Error checking auth status:', error);
                updateAuthUI();
            }
        }

        // Update authentication UI based on current state
        function updateAuthUI() {
            const authStatus = document.getElementById('authStatus');
            const authUserInfo = document.getElementById('authUserInfo');
            const authSignIn = document.getElementById('authSignIn');
            const authSignOut = document.getElementById('authSignOut');
            const authUsername = document.getElementById('authUsername');
            const authRegion = document.getElementById('authRegion');

            if (authState.authenticated && authState.user) {
                // User is authenticated
                authStatus.textContent = authState.tokenExpired ? 'Token expired' : 'Authenticated';
                authStatus.className = `auth-status ${authState.tokenExpired ? 'expired' : 'authenticated'}`;
                
                authUserInfo.style.display = 'flex';
                authSignIn.style.display = 'none';
                authSignOut.style.display = 'inline-flex';
                
                authUsername.textContent = authState.user.sub || 'Unknown User';
                authRegion.textContent = authState.user.cpid || 'Unknown';
                
                if (authState.tokenExpired) {
                    authSignOut.innerHTML = '<span>🔄</span> Refresh Token';
                    authSignOut.onclick = handleTokenRefresh;
                } else {
                    authSignOut.innerHTML = '<span>🚪</span> Sign Out';
                    authSignOut.onclick = handleLogout;
                }
            } else {
                // User is not authenticated
                authStatus.textContent = 'Not authenticated';
                authStatus.className = 'auth-status';
                
                authUserInfo.style.display = 'none';
                authSignIn.style.display = 'inline-flex';
                authSignOut.style.display = 'none';
            }
        }

        // Handle user logout
        async function handleLogout() {
            try {
                const response = await fetch('/auth/logout', { method: 'POST' });
                if (response.ok) {
                    authState = { authenticated: false, user: null, tokenExpired: false };
                    updateAuthUI();
                    showNotification('Successfully signed out', 'info');
                } else {
                    showNotification('Error signing out', 'error');
                }
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('Error signing out', 'error');
            }
        }

        // Handle token refresh
        async function handleTokenRefresh() {
            try {
                const response = await fetch('/auth/refresh', { method: 'POST' });
                if (response.ok) {
                    await checkAuthStatus();
                    showNotification('Token refreshed successfully', 'success');
                } else {
                    showNotification('Failed to refresh token. Please sign in again.', 'error');
                    // Clear auth state and redirect to sign in
                    authState = { authenticated: false, user: null, tokenExpired: false };
                    updateAuthUI();
                }
            } catch (error) {
                console.error('Token refresh error:', error);
                showNotification('Failed to refresh token', 'error');
            }
        }

        // Fetch user info from RSO userinfo endpoint
        async function fetchUserInfo() {
            if (!authState.authenticated) return null;
            
            try {
                const response = await fetch('/auth/userinfo');
                if (response.ok) {
                    const data = await response.json();
                    authState.user = data.user;
                    updateAuthUI();
                    return data;
                } else if (response.status === 401) {
                    // Token expired, update state
                    authState.tokenExpired = true;
                    updateAuthUI();
                }
            } catch (error) {
                console.error('Error fetching user info:', error);
            }
            return null;
        }

        // Show notification (you can customize this)
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                max-width: 300px;
                transition: all 0.3s ease;
            `;
            
            // Set colors based on type
            switch (type) {
                case 'success':
                    notification.style.background = 'linear-gradient(135deg, #22c55e, #16a34a)';
                    break;
                case 'error':
                    notification.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                    break;
                case 'info':
                default:
                    notification.style.background = 'linear-gradient(135deg, #3b82f6, #2563eb)';
                    break;
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove after 4 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Initialize authentication on page load
        document.addEventListener('DOMContentLoaded', checkAuthStatus);

        // Match Details Functions
        async function openMatchDetails(matchId, region) {
            const modal = document.getElementById('matchDetailsModal');
            modal.classList.add('active');
            
            // Show loading state
            document.getElementById('gameMode').textContent = 'Loading match details...';
            document.getElementById('matchDuration').textContent = '--:--';
            document.getElementById('blueTeamScore').textContent = '0';
            document.getElementById('redTeamScore').textContent = '0';
            
            try {
                const response = await fetch(`/api/match/${matchId}?region=${region}`);
                if (!response.ok) {
                    throw new Error(`Failed to fetch match details: ${response.status}`);
                }
                
                const data = await response.json();
                populateMatchDetails(data.match);
            } catch (error) {
                console.error('Error fetching match details:', error);
                showNotification('Failed to load match details', 'error');
                document.getElementById('gameMode').textContent = 'Error loading match details';
            }
        }

        function populateMatchDetails(match) {
            // Update match overview
            document.getElementById('matchDuration').textContent = `${match.durationMinutes}m`;
            document.getElementById('gameMode').textContent = match.gameMode;
            
            // Update team scores
            const blueTeam = match.teams.find(t => t.teamId === 100);
            const redTeam = match.teams.find(t => t.teamId === 200);
            
            document.getElementById('blueTeamScore').textContent = blueTeam.kills;
            document.getElementById('redTeamScore').textContent = redTeam.kills;
            document.getElementById('blueTeamKDA').textContent = `${blueTeam.kills}/${blueTeam.deaths}/${blueTeam.assists}`;
            document.getElementById('redTeamKDA').textContent = `${redTeam.kills}/${redTeam.deaths}/${redTeam.assists}`;
            
            // Populate team players
            populateTeamPlayers('blueTeamPlayers', match.blueTeam);
            populateTeamPlayers('redTeamPlayers', match.redTeam);
            
            // Populate objectives
            populateObjectives('blueObjectives', blueTeam.objectives);
            populateObjectives('redObjectives', redTeam.objectives);
        }

        function populateTeamPlayers(containerId, players) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            players.forEach(player => {
                const playerRow = document.createElement('div');
                playerRow.className = 'player-row clickable-player';
                
                // Build items HTML
                const itemsHTML = Array.from({length: 6}, (_, i) => {
                    const item = player.items[i];
                    if (item && item !== 0) {
                        return `<div class="item-icon" style="background-image: url('https://ddragon.leagueoflegends.com/cdn/${PATCH_VERSION}/img/item/${item}.png')"></div>`;
                    }
                    return `<div class="item-icon empty"></div>`;
                }).join('');
                
                playerRow.innerHTML = `
                    <div class="player-champion" style="background-image: url('${buildChampionIconUrl(player.championName)}')"></div>
                    <div class="player-info">
                        <div class="player-name">${player.summonerName}${player.tagLine ? '#' + player.tagLine : ''}</div>
                        <div class="player-role">${player.teamPosition}</div>
                    </div>
                    <div class="player-kda">
                        ${player.kills}/${player.deaths}/${player.assists}
                        <div style="font-size: 11px; color: var(--text-soft);">${player.kda} KDA</div>
                    </div>
                    <div class="player-cs">
                        ${player.cs} CS
                        <div style="font-size: 11px; color: var(--text-soft);">${player.csPerMinute}/min</div>
                    </div>
                    <div class="player-damage">
                        ${(player.totalDamageDealt / 1000).toFixed(1)}k
                        <div style="font-size: 11px; color: var(--text-soft);">${player.damageShare}%</div>
                    </div>
                    <div class="player-items">
                        ${itemsHTML}
                    </div>
                    <div class="click-indicator">
                        <span>👆 View Profile</span>
                    </div>
                `;
                
                // Add click handler to fetch player profile
                playerRow.addEventListener('click', () => {
                    const playerName = player.summonerName + (player.tagLine ? '#' + player.tagLine : '');
                    const region = getCurrentRegion();
                    fetchPlayerProfile(playerName, region);
                });
                
                container.appendChild(playerRow);
            });
        }

        function populateObjectives(containerId, objectives) {
            const container = document.getElementById(containerId);
            
            const objectivesList = [
                { key: 'baron', icon: '🐉', name: 'Baron', count: objectives.baron },
                { key: 'dragon', icon: '🔥', name: 'Dragon', count: objectives.dragon },
                { key: 'tower', icon: '🏰', name: 'Towers', count: objectives.tower },
                { key: 'inhibitor', icon: '💎', name: 'Inhibs', count: objectives.inhibitor }
            ];
            
            container.innerHTML = objectivesList.map(obj => `
                <div class="objective-item">
                    <span class="objective-icon">${obj.icon}</span>
                    <div class="objective-count">${obj.count}</div>
                    <div class="objective-name">${obj.name}</div>
                </div>
            `).join('');
        }

        function closeMatchDetails() {
            const modal = document.getElementById('matchDetailsModal');
            modal.classList.remove('active');
        }

        // Close modal when clicking outside of it
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('matchDetailsModal');
            if (event.target === modal) {
                closeMatchDetails();
            }
        });

        // Get current region from the search form or default to na1
        function getCurrentRegion() {
            const regionSelect = document.getElementById('region');
            return regionSelect ? regionSelect.value : 'na1';
        }

        // Fetch player profile when clicking on a player in match details
        async function fetchPlayerProfile(playerName, region) {
            try {
                // Show loading state
                showPlayerProfileLoading(playerName);
                
                // Build query parameters - API expects 'region' and 'name'
                const params = new URLSearchParams({
                    region: region,
                    name: playerName
                });
                
                console.log(`Fetching profile: ${playerName} in region ${region}`);
                console.log(`API URL: /api/summoner?${params.toString()}`);
                
                const response = await fetch(`/api/summoner?${params.toString()}`);
                
                // Check if response is ok
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('API Response:', data);
                
                // The API response structure is the same as normal search
                // Show success notification
                showNotification(`Successfully loaded profile for ${playerName}!`, 'success');
                
                // Close match details modal
                closeMatchDetails();
                
                // Update the main profile with the fetched player data using the same method as normal search
                displayPlayerProfile(data, playerName, region);
                
                // Scroll to profile section
                scrollToSection('profile');
            } catch (error) {
                console.error('Error fetching player profile:', error);
                showPlayerProfileError(playerName, `Failed to load player profile: ${error.message}`);
            }
        }

        function showPlayerProfileLoading(playerName) {
            // Show loading toast or indicator
            showNotification(`Loading profile for ${playerName}...`, 'info');
        }

        function showPlayerProfileError(playerName, error) {
            // Show error notification instead of alert
            showNotification(`Failed to load profile for ${playerName}: ${error}`, 'error');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${type === 'error' ? '❌' : type === 'success' ? '✅' : 'ℹ️'}</span>
                    <span class="notification-message">${message}</span>
                </div>
            `;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Trigger animation
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto remove after delay
            setTimeout(() => {
                notification.classList.add('hide');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, type === 'error' ? 4000 : 2000);
        }

        function displayPlayerProfile(summoner, playerName, region) {
            // Update the search form to show the current player
            const [name, tagline] = playerName.includes('#') ? playerName.split('#') : [playerName, ''];
            
            const summonerNameInput = document.getElementById('summonerName');
            const summonerTaglineInput = document.getElementById('summonerTagline');
            const regionSelect = document.getElementById('regionSelect');
            
            if (summonerNameInput) {
                summonerNameInput.value = name;
            }
            if (summonerTaglineInput) {
                summonerTaglineInput.value = tagline;
            }
            if (regionSelect) {
                regionSelect.value = region;
            }
            
            // Update profile data using the same method as normal search
            applySummonerData(summoner);
        }



        const PATCH_VERSION = "14.15.1";
        const queueLabels = {
            RANKED_SOLO: "Ranked Solo",
            RANKED_FLEX: "Ranked Flex",
            ARAM: "ARAM"
        };

        const regionalLeaderboards = {
            kr: [
                { rank: 1, name: "T1 Faker", lp: 1540, wr: "64%", role: "Mid" },
                { rank: 2, name: "Gen G Peyz", lp: 1498, wr: "61%", role: "ADC" },
                { rank: 3, name: "DRX BeryL", lp: 1435, wr: "59%", role: "Support" },
                { rank: 4, name: "DK Canyon", lp: 1386, wr: "57%", role: "Jungle" },
                { rank: 5, name: "T1 Zeus", lp: 1354, wr: "60%", role: "Top" }
            ],
            na1: [
                { rank: 1, name: "C9 Jojopyun", lp: 1492, wr: "63%", role: "Mid" },
                { rank: 2, name: "TL CoreJJ", lp: 1467, wr: "61%", role: "Support" },
                { rank: 3, name: "100T Closer", lp: 1441, wr: "59%", role: "Jungle" },
                { rank: 4, name: "TSM Tactical", lp: 1418, wr: "58%", role: "ADC" },
                { rank: 5, name: "FLY Impact", lp: 1395, wr: "57%", role: "Top" }
            ],
            euw1: [
                { rank: 1, name: "G2 Caps", lp: 1523, wr: "65%", role: "Mid" },
                { rank: 2, name: "FNC Humanoid", lp: 1489, wr: "62%", role: "Mid" },
                { rank: 3, name: "MAD Kaiser", lp: 1456, wr: "60%", role: "Support" },
                { rank: 4, name: "VIT Photon", lp: 1428, wr: "58%", role: "ADC" },
                { rank: 5, name: "BDS Adam", lp: 1403, wr: "57%", role: "Top" }
            ],
            eun1: [
                { rank: 1, name: "Mocha47", lp: 1467, wr: "62%", role: "Mid" },
                { rank: 2, name: "EUNE Predator", lp: 1434, wr: "60%", role: "Jungle" },
                { rank: 3, name: "Nordic Saber", lp: 1401, wr: "58%", role: "Top" },
                { rank: 4, name: "Balkan Sniper", lp: 1378, wr: "57%", role: "ADC" },
                { rank: 5, name: "Czech Guardian", lp: 1355, wr: "56%", role: "Support" }
            ],
            br1: [
                { rank: 1, name: "LOUD brTT", lp: 1478, wr: "63%", role: "ADC" },
                { rank: 2, name: "paiN Tinowns", lp: 1445, wr: "61%", role: "Mid" },
                { rank: 3, name: "FURIA Robo", lp: 1412, wr: "59%", role: "Jungle" },
                { rank: 4, name: "RED Guigo", lp: 1389, wr: "58%", role: "Top" },
                { rank: 5, name: "KBM Jockster", lp: 1366, wr: "57%", role: "Support" }
            ],
            jp1: [
                { rank: 1, name: "DFM Yutapon", lp: 1456, wr: "62%", role: "ADC" },
                { rank: 2, name: "SG Evi", lp: 1423, wr: "60%", role: "Top" },
                { rank: 3, name: "BC Steal", lp: 1390, wr: "58%", role: "Jungle" },
                { rank: 4, name: "V3 Archer", lp: 1367, wr: "57%", role: "Mid" },
                { rank: 5, name: "CGA Gango", lp: 1344, wr: "56%", role: "Support" }
            ],
            ru: [
                { rank: 1, name: "Diamondprox", lp: 1489, wr: "63%", role: "Jungle" },
                { rank: 2, name: "Alex Ich", lp: 1456, wr: "61%", role: "Mid" },
                { rank: 3, name: "Edward", lp: 1423, wr: "59%", role: "Support" },
                { rank: 4, name: "Darien", lp: 1390, wr: "58%", role: "Top" },
                { rank: 5, name: "Genja", lp: 1367, wr: "57%", role: "ADC" }
            ],
            oc1: [
                { rank: 1, name: "ORDER Tally", lp: 1434, wr: "61%", role: "Mid" },
                { rank: 2, name: "GRV Topoon", lp: 1401, wr: "59%", role: "Top" },
                { rank: 3, name: "LGC Babip", lp: 1378, wr: "58%", role: "Jungle" },
                { rank: 4, name: "DW FBI", lp: 1355, wr: "57%", role: "ADC" },
                { rank: 5, name: "PCE Huhi", lp: 1332, wr: "56%", role: "Support" }
            ],
            tr1: [
                { rank: 1, name: "SUP Zeitnot", lp: 1445, wr: "62%", role: "Mid" },
                { rank: 2, name: "GAL Closer", lp: 1412, wr: "60%", role: "Jungle" },
                { rank: 3, name: "FB Armut", lp: 1389, wr: "58%", role: "Top" },
                { rank: 4, name: "DP HolyPhoenix", lp: 1366, wr: "57%", role: "ADC" },
                { rank: 5, name: "BJK Zeitnot", lp: 1343, wr: "56%", role: "Support" }
            ],
            la1: [
                { rank: 1, name: "EST Josedeodo", lp: 1467, wr: "62%", role: "Jungle" },
                { rank: 2, name: "R7 Seiya", lp: 1434, wr: "60%", role: "Mid" },
                { rank: 3, name: "INF Bugi", lp: 1401, wr: "58%", role: "Top" },
                { rank: 4, name: "AK Mystiques", lp: 1378, wr: "57%", role: "ADC" },
                { rank: 5, name: "XTN Slow", lp: 1355, wr: "56%", role: "Support" }
            ],
            la2: [
                { rank: 1, name: "KRU Keznit", lp: 1478, wr: "63%", role: "ADC" },
                { rank: 2, name: "LEV kingg", lp: 1445, wr: "61%", role: "Mid" },
                { rank: 3, name: "9z daveeys", lp: 1412, wr: "59%", role: "Jungle" },
                { rank: 4, name: "FUR Havoks", lp: 1389, wr: "58%", role: "Top" },
                { rank: 5, name: "ISG Slowness", lp: 1366, wr: "57%", role: "Support" }
            ]
        };

        const leaderboardFallback = regionalLeaderboards.kr;

        const fallbackData = {
            profile: {
                name: "SummonerName",
                region: "na1",
                regionDisplay: "NA",
                level: 218,
                bannerClip: "https://interactive-examples.mdn.mozilla.org/media/cc0-videos/flower.mp4",
                metaLine: "NA · Level 218 · Top 3.2%",
                headline: "Gold II · 52.3% Winrate",
                rankLabel: "Ranked Solo · Gold II",
                roles: ["Mid", "Jungle", "Fill"],
                highlights: [
                    "15.4 KDA Syndra carry",
                    "18 assists on Thresh",
                    "Samira Pentakill last session"
                ],
                stats: {
                    winRate: { value: "52%", subtext: "214 wins, 197 losses" },
                    seasonWins: { value: "214", subtext: "+12 in the last week" },
                    averageKDA: { value: "3.68", subtext: "Across 5 recent ranked games" },
                    damageShare: { value: "29%", subtext: "+8% vs role average" },
                    visionScore: { value: "32", subtext: "Average per game" }
                }
            },
            matches: {
                RANKED_SOLO: [
                    {
                        champion: "Ahri",
                        role: "Mid",
                        kda: "12 / 3 / 9",
                        kdaValue: 7,
                        result: "win",
                        duration: "32m",
                        cs: "264 CS",
                        kp: "72% KP",
                        timeAgo: "2 hours ago"
                    },
                    {
                        champion: "Lee Sin",
                        role: "Jungle",
                        kda: "6 / 5 / 14",
                        kdaValue: 4,
                        result: "win",
                        duration: "28m",
                        cs: "194 CS",
                        kp: "68% KP",
                        timeAgo: "5 hours ago"
                    },
                    {
                        champion: "Syndra",
                        role: "Mid",
                        kda: "3 / 7 / 4",
                        kdaValue: 1,
                        result: "loss",
                        duration: "25m",
                        cs: "182 CS",
                        kp: "46% KP",
                        timeAgo: "8 hours ago"
                    },
                    {
                        champion: "Samira",
                        role: "ADC",
                        kda: "18 / 2 / 8",
                        kdaValue: 13,
                        result: "win",
                        duration: "38m",
                        cs: "302 CS",
                        kp: "64% KP",
                        timeAgo: "1 day ago"
                    },
                    {
                        champion: "Thresh",
                        role: "Support",
                        kda: "2 / 1 / 23",
                        kdaValue: 25,
                        result: "win",
                        duration: "30m",
                        cs: "24 CS",
                        kp: "85% KP",
                        timeAgo: "1 day ago"
                    }
                ],
                RANKED_FLEX: [
                    {
                        champion: "Lux",
                        role: "Support",
                        kda: "5 / 2 / 18",
                        kdaValue: 11.5,
                        result: "win",
                        duration: "27m",
                        cs: "34 CS",
                        kp: "82% KP",
                        timeAgo: "3 days ago"
                    },
                    {
                        champion: "Ezreal",
                        role: "ADC",
                        kda: "7 / 6 / 5",
                        kdaValue: 2,
                        result: "loss",
                        duration: "31m",
                        cs: "288 CS",
                        kp: "59% KP",
                        timeAgo: "4 days ago"
                    }
                ],
                ARAM: [
                    {
                        champion: "Ziggs",
                        role: "Mage",
                        kda: "14 / 4 / 24",
                        kdaValue: 9.5,
                        result: "win",
                        duration: "20m",
                        cs: "84 CS",
                        kp: "78% KP",
                        timeAgo: "2 days ago"
                    },
                    {
                        champion: "Velkoz",
                        role: "Mage",
                        kda: "10 / 9 / 19",
                        kdaValue: 3.2,
                        result: "loss",
                        duration: "22m",
                        cs: "68 CS",
                        kp: "65% KP",
                        timeAgo: "2 days ago"
                    }
                ]
            },
            champions: [
                {
                    name: "Jinx",
                    role: "ADC",
                    winRate: "72.4%",
                    kda: "9.2 / 2.8 / 6.4",
                    games: 29,
                    avgCs: "174",
                    avgDamage: "28.5K"
                },
                {
                    name: "Graves",
                    role: "Jungle", 
                    winRate: "68.8%",
                    kda: "7.1 / 3.2 / 5.9",
                    games: 25,
                    avgCs: "156",
                    avgDamage: "22.1K"
                },
                {
                    name: "Azir",
                    role: "Mid",
                    winRate: "65.2%",
                    kda: "8.4 / 2.9 / 7.6",
                    games: 23,
                    avgCs: "198",
                    avgDamage: "25.8K"
                }
            ],
            leaderboard: null, // Will be loaded by fetchLeaderboardData
            meta: { source: "fallback" }
        };

        let state = clone(fallbackData);
        state.selectedRegion = "kr"; // Initialize with default region
        let activeQueue = "RANKED_SOLO";

        function clone(obj) {
            return JSON.parse(JSON.stringify(obj));
        }

        function formatGamesLabel(total) {
            if (!total) return "No ranked games yet";
            return total === 1 ? "1 game played" : `${total} games played`;
        }

        function buildChampionIconUrl(name) {
            const cleaned = (name || "Teemo").replace(/[^A-Za-z]/g, "");
            return `https://ddragon.leagueoflegends.com/cdn/${PATCH_VERSION}/img/champion/${cleaned}.png`;
        }

        function renderProfile() {
            const profile = state.profile || fallbackData.profile;
            
            // Update avatar with summoner icon
            const avatar = document.querySelector('.avatar.avatar-lg');
            if (avatar) {
                const iconId = profile.profileIconId || 4569; // Default icon ID
                avatar.style.backgroundImage = `url('https://ddragon.leagueoflegends.com/cdn/14.15.1/img/profileicon/${iconId}.png')`;
            }
            
            // Update banner based on clip status
            const banner = document.getElementById('profileBanner');
            if (banner) {
                if (profile.bannerClip) {
                    banner.classList.add('has-video');
                    banner.innerHTML = `
                        <video autoplay muted loop>
                            <source src="${profile.bannerClip}" type="video/mp4">
                            Your browser does not support video.
                        </video>
                        <span class="play-pill">▶ Play Highlight</span>
                        <div class="banner-actions" onclick="event.stopPropagation()">
                            <button class="btn-mini" onclick="setBannerClip()">Set URL</button>
                            <button class="btn-mini" onclick="document.getElementById('uploadVideo').click()">Upload</button>
                        </div>
                        <input type="file" id="uploadVideo" accept="video/*" style="display:none" onchange="handleVideoUpload(event)">
                    `;
                } else {
                    banner.classList.remove('has-video');
                    banner.innerHTML = `
                        <div class="empty-banner-state">
                            <p style="font-size:1.1rem; margin-bottom:8px;">No Highlight Video Set</p>
                            <p style="font-size:0.9rem; color:var(--text-muted);">Upload a video or set URL to showcase your best plays</p>
                        </div>
                        <div class="banner-actions" onclick="event.stopPropagation()">
                            <button class="btn-mini" onclick="setBannerClip()">Set URL</button>
                            <button class="btn-mini" onclick="document.getElementById('uploadVideo').click()">Upload</button>
                        </div>
                        <input type="file" id="uploadVideo" accept="video/*" style="display:none" onchange="handleVideoUpload(event)">
                    `;
                }
            }
            
            console.log("Rendering profile with name:", profile.name, "full profile:", profile);
            const nameEl = document.getElementById("profileName");
            if (nameEl) {
                const nameValue = profile.name ?? "Summoner";
                nameEl.textContent = nameValue;
            }
            
            const profileMetaEl = document.getElementById("profileMeta");
            if (profileMetaEl) {
                profileMetaEl.textContent = profile.metaLine ?? `${profile.regionDisplay ?? "NA"} · Level ${profile.level ?? "--"}`;
            }
            
            const rankLabelEl = document.getElementById("rankLabel");
            if (rankLabelEl) {
                rankLabelEl.textContent = profile.rankLabel ?? "Ranked Solo · Unranked";
            }
            
            const profileHeadlineEl = document.getElementById("profileHeadline");
            if (profileHeadlineEl) {
                profileHeadlineEl.textContent = profile.headline ?? "Unranked · Grind placements to unlock rank data";
            }

            const rolesEl = document.getElementById("preferredRoles");
            if (rolesEl) {
                rolesEl.textContent = (profile.roles && profile.roles.length)
                    ? profile.roles.join(" · ")
                    : "Fill";
            }

            const highlightsEl = document.getElementById("profileHighlights");
            if (highlightsEl) {
                highlightsEl.textContent = (profile.highlights && profile.highlights.length)
                    ? profile.highlights.join(" · ")
                    : "Play more matches to unlock highlights";
            }

            const stats = profile.stats || {};
            
            const seasonWinsValueEl = document.getElementById("statSeasonWinsValue");
            if (seasonWinsValueEl) {
                seasonWinsValueEl.textContent = stats.seasonWins?.value ?? fallbackData.profile.stats.seasonWins.value;
            }
            
            const seasonWinsSubtextEl = document.getElementById("statSeasonWinsSubtext");
            if (seasonWinsSubtextEl) {
                seasonWinsSubtextEl.textContent = stats.seasonWins?.subtext ?? fallbackData.profile.stats.seasonWins.subtext;
            }
            
            const averageKDAValueEl = document.getElementById("statAverageKDAValue");
            if (averageKDAValueEl) {
                averageKDAValueEl.textContent = stats.averageKDA?.value ?? fallbackData.profile.stats.averageKDA.value;
            }
            
            const averageKDASubtextEl = document.getElementById("statAverageKDASubtext");
            if (averageKDASubtextEl) {
                averageKDASubtextEl.textContent = stats.averageKDA?.subtext ?? fallbackData.profile.stats.averageKDA.subtext;
            }
            
            const damageShareValueEl = document.getElementById("statDamageShareValue");
            if (damageShareValueEl) {
                damageShareValueEl.textContent = stats.damageShare?.value ?? fallbackData.profile.stats.damageShare.value;
            }
            
            const damageShareSubtextEl = document.getElementById("statDamageShareSubtext");
            if (damageShareSubtextEl) {
                damageShareSubtextEl.textContent = stats.damageShare?.subtext ?? fallbackData.profile.stats.damageShare.subtext;
            }
            
            const visionScoreValueEl = document.getElementById("statVisionScoreValue");
            if (visionScoreValueEl) {
                visionScoreValueEl.textContent = stats.visionScore?.value ?? fallbackData.profile.stats.visionScore.value;
            }
            
            const visionScoreSubtextEl = document.getElementById("statVisionScoreSubtext");
            if (visionScoreSubtextEl) {
                visionScoreSubtextEl.textContent = stats.visionScore?.subtext ?? fallbackData.profile.stats.visionScore.subtext;
            }

            // Update enhanced 4-box stats
            const performanceEl = document.getElementById("statPerformanceValue");
            if (performanceEl) {
                // Calculate performance score from win rate and KDA
                const winRate = parseInt(stats.winRate?.value) || 50;
                const kda = parseFloat(stats.averageKDA?.value) || 2.0;
                const performanceScore = ((winRate / 100) * 5 + Math.min(kda / 2, 5)).toFixed(1);
                performanceEl.textContent = performanceScore;
            }
            const performanceSubtextEl = document.getElementById("statPerformanceSubtext");
            if (performanceSubtextEl) {
                const winRate = stats.winRate?.value ?? "50%";
                const wins = stats.seasonWins?.value ?? "0";
                const perfectKDA = stats.perfectKDA?.value ?? "0%";
                performanceSubtextEl.innerHTML = `<span style="color: #4ade80">${winRate} WR</span> • <span style="color: #60a5fa">${wins} Wins</span> • <span style="color: #fbbf24">${perfectKDA} Perfect KDA</span>`;
            }

            const combatEl = document.getElementById("statCombatValue");
            if (combatEl) {
                combatEl.textContent = stats.averageKDA?.value ?? "3.68";
            }
            const combatSubtextEl = document.getElementById("statCombatSubtext");
            if (combatSubtextEl) {
                const multikills = stats.multikills?.value ?? "15";
                combatSubtextEl.innerHTML = `<span style="color: #4ade80">6.2</span> / <span style="color: #ef4444">1.7</span> / <span style="color: #60a5fa">5.8</span> • <span style="color: #f59e0b">${multikills} Multikills</span>`;
            }

            const economyEl = document.getElementById("statEconomyValue");
            if (economyEl) {
                economyEl.textContent = stats.csPerMinute?.value ?? "7.8";
            }
            const economySubtextEl = document.getElementById("statEconomySubtext");
            if (economySubtextEl) {
                const gold = stats.goldPerGame?.value ?? "13.5K";
                const cs = stats.csPerMinute?.subtext?.split(' ')[0] ?? "156";
                economySubtextEl.innerHTML = `<span style="color: #fbbf24">CS/min</span> • <span style="color: #4ade80">${gold} Gold</span> • <span style="color: #60a5fa">${cs} CS/game</span>`;
            }

            const impactEl = document.getElementById("statImpactValue");
            if (impactEl) {
                impactEl.textContent = stats.damageShare?.value ?? "29%";
            }
            const impactSubtextEl = document.getElementById("statImpactSubtext");
            if (impactSubtextEl) {
                const damage = stats.damagePerGame?.value ?? "24.8K";
                const vision = stats.visionScore?.value ?? "32";
                impactSubtextEl.innerHTML = `<span style="color: #ef4444">${damage} Damage</span> • <span style="color: #60a5fa">${vision} Vision</span> • <span style="color: #4ade80">72% KP</span>`;
            }
            
            // Update spotlight stats (under logo)
            updateSpotlightStats(profile);
        }

        function updateSpotlightStats(profile) {
            const stats = profile.stats || {};
            
            // Win Rate from calculated stat
            const winRateValue = stats.winRate?.value || "52%";
            
            // KDA Ratio from averageKDA
            const kdaValue = stats.averageKDA?.value || "3.42";
            
            // Damage Share - format as percentage or value
            const damageValue = stats.damageShare?.value || "24.8K";
            
            // Vision Score
            const visionValue = stats.visionScore?.value || "42.6";
            
            // Update DOM elements
            const winRateEl = document.getElementById("statWinRateValue");
            if (winRateEl) winRateEl.textContent = winRateValue;
            
            const kdaEl = document.getElementById("statKDAValue");
            if (kdaEl) kdaEl.textContent = kdaValue;
            
            const damageEl = document.getElementById("statDamageValue");
            if (damageEl) damageEl.textContent = damageValue;
            
            const visionEl = document.getElementById("statVisionValue");
            if (visionEl) visionEl.textContent = visionValue;
        }

        function renderMatches(queueKey = activeQueue) {
            activeQueue = queueKey;
            const container = document.getElementById("matchList");
            container.innerHTML = "";
            const matches = state.matches?.[queueKey] || [];

            if (!matches.length) {
                const empty = document.createElement("p");
                empty.className = "stat-subtext";
                empty.textContent = `No ${queueLabels[queueKey] || "matches"} recorded yet.`;
                container.appendChild(empty);
                return;
            }

            matches.forEach(match => {
                const card = document.createElement("article");
                card.className = "match-card";
                const iconUrl = buildChampionIconUrl(match.champion);
                
                // Make match card clickable if matchId is available
                if (match.matchId && state.profile?.region) {
                    card.style.cursor = 'pointer';
                    card.onclick = () => openMatchDetails(match.matchId, state.profile.region);
                    card.title = 'Click to view detailed match information';
                }
                
                card.innerHTML = `
                    <div class="match-meta">
                        <div class="champ-icon" style="background-image:url('${iconUrl}')"></div>
                        <div>
                            <p class="match-result ${match.result}">${match.result === "win" ? "Victory" : "Defeat"}</p>
                            <p class="stat-subtext">${match.role || "—"} · ${match.duration || ""}</p>
                        </div>
                    </div>
                    <div class="match-stats">
                        <strong>${match.kda || "0 / 0 / 0"}</strong>
                        <p class="stat-subtext">K/D/A</p>
                    </div>
                    <div>
                        <p class="stat-subtext">${match.cs || ""}</p>
                        <p class="stat-subtext">${match.kp || ""}</p>
                    </div>
                    <div class="match-time">${match.timeAgo || "Recently"}</div>
                    ${match.matchId ? '<div class="match-details-hint" style="font-size: 11px; color: var(--text-soft); text-align: center; margin-top: 4px;">Click for details</div>' : ''}
                `;
                container.appendChild(card);
            });
        }

        function renderChampions() {
            const grid = document.getElementById("champGrid");
            grid.innerHTML = "";
            const champions = state.champions || fallbackData.champions || [];

            if (!champions.length) {
                const empty = document.createElement("p");
                empty.className = "stat-subtext";
                empty.textContent = "No champion performance data available yet.";
                grid.appendChild(empty);
                return;
            }

            champions.forEach(champ => {
                const card = document.createElement("article");
                card.className = "champ-card";
                const iconUrl = buildChampionIconUrl(champ.name);
                const gamesLabel = formatGamesLabel(champ.games || 0);
                card.innerHTML = `
                    <div class="champ-overlay"></div>
                    <div class="mastery-badge" title="${champ.games || 0} Games Played">
                        ${champ.games || 0}
                    </div>
                    <span class="champ-role">${champ.role || "Role"}</span>
                    <h3 class="champ-name">${champ.name || "Champion"}</h3>
                    <div class="champ-meta">
                        <div class="stat-group">
                            <span class="stat-value">${champ.winRate || "—"}</span>
                            <span class="stat-label">Win Rate</span>
                        </div>
                        <div class="stat-group">
                            <span class="stat-value">${champ.kda || "—"}</span>
                            <span class="stat-label">KDA</span>
                        </div>
                    </div>
                `;
                const champName = champ.name.replace(/[^A-Za-z]/g, "");
                const splashUrl = `https://ddragon.leagueoflegends.com/cdn/img/champion/splash/${champName}_0.jpg`;
                
                // Preload the image to ensure proper sizing
                const img = new Image();
                img.onload = () => {
                    card.style.setProperty('--champ-splash', `url(${splashUrl})`);
                };
                img.onerror = () => {
                    // Fallback to centered icon if splash fails
                    const iconUrl = buildChampionIconUrl(champ.name);
                    card.style.setProperty('--champ-splash', `url(${iconUrl})`);
                    card.classList.add('fallback-icon');
                };
                img.src = splashUrl;
                
                card.style.backgroundColor = 'var(--bg-card-dark)';
                grid.appendChild(card);
            });
        }

        function renderLeaderboard() {
            console.log("renderLeaderboard called with region:", state.selectedRegion);
            const tbody = document.getElementById("leaderboardBody");
            if (!tbody) {
                console.error("leaderboardBody element not found");
                return;
            }
            tbody.innerHTML = "";
            const leaderboard = state.leaderboard;
            
            if (!leaderboard) {
                // Show loading message if no leaderboard data yet
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px;">Loading live leaderboard data...</td></tr>';
                return;
            }
            
            console.log("Using leaderboard data:", leaderboard);
            const regionSelect = document.getElementById("leaderboardRegionSelect");
            
            // Ensure region select matches state
            if (regionSelect && regionSelect.value !== state.selectedRegion) {
                regionSelect.value = state.selectedRegion;
            }

            // Update section header to show current region
            const sectionHeader = document.querySelector("#leaderboard .section-header span");
            const regionNames = {
                kr: "KR", na1: "NA", euw1: "EUW", eun1: "EUNE", 
                br1: "BR", jp1: "JP", ru: "RU", oc1: "OCE", 
                tr1: "TR", la1: "LAN", la2: "LAS"
            };
            const regionName = regionNames[state.selectedRegion] || "KR";
            sectionHeader.textContent = `${regionName} · Top 5 Summoners`;

            leaderboard.forEach((entry, index) => {
                if (index === 0) {
                    console.log("Rendering first entry:", entry);
                    console.log("LP value:", entry.lp, "Type:", typeof entry.lp);
                }
                const row = document.createElement("tr");
                row.style.cursor = "pointer";
                row.setAttribute("data-player-name", entry.name);
                row.setAttribute("data-region", state.selectedRegion);
                row.innerHTML = `
                    <td>#${entry.rank}</td>
                    <td>${entry.name}</td>
                    <td>${entry.lp}</td>
                    <td>${entry.wr}</td>
                    <td>${entry.role}</td>
                `;
                
                // Add click handler to fetch player profile
                row.addEventListener('click', async function() {
                    console.log(`Clicked on leaderboard entry: ${entry.name} in region ${state.selectedRegion}`);
                    
                    // Show loading notification
                    showNotification(`Loading ${entry.name}'s profile...`, 'info');
                    
                    try {
                        // Parse the name#tag format
                        const fullName = entry.name;
                        let gameName, tagLine;
                        
                        if (fullName.includes('#')) {
                            [gameName, tagLine] = fullName.split('#');
                        } else {
                            gameName = fullName;
                            tagLine = state.selectedRegion.toUpperCase();
                        }
                        
                        console.log(`Fetching profile for: ${gameName}#${tagLine} in region ${state.selectedRegion}`);
                        
                        // Fetch the player profile using the existing API
                        const response = await fetch(`/api/summoner?region=${state.selectedRegion}&name=${encodeURIComponent(gameName + '#' + tagLine)}`);
                        
                        if (!response.ok) {
                            throw new Error(`Failed to fetch profile: ${response.status}`);
                        }
                        
                        const profileData = await response.json();
                        console.log('Received profile data:', profileData);
                        
                        // Apply the new profile data to the page
                        applySummonerData(profileData, `${gameName}#${tagLine}`, state.selectedRegion);
                        
                        // Scroll to profile section smoothly
                        const profileSection = document.getElementById('profile');
                        if (profileSection) {
                            const headerHeight = document.querySelector('header').offsetHeight;
                            const targetPosition = profileSection.offsetTop - headerHeight - 20;
                            
                            window.scrollTo({
                                top: targetPosition,
                                behavior: 'smooth'
                            });
                        }
                        
                        showNotification(`Loaded ${entry.name}'s profile successfully!`, 'success');
                        
                    } catch (error) {
                        console.error('Error fetching leaderboard player profile:', error);
                        showNotification(`Failed to load ${entry.name}'s profile: ${error.message}`, 'error');
                    }
                });
                
                tbody.appendChild(row);
            });
        }

        function renderAll() {
            renderProfile();
            renderMatches(activeQueue);
            renderChampions();
            renderLeaderboard();
        }

        function applySummonerData(payload) {
            state.meta = payload?.meta || null;
            if (payload?.meta?.source === "cache") {
                console.info(`Served from cache. Cached at: ${payload.meta.cachedAt || "unknown time"}.`);
            }
            const isLive = payload?.meta?.source === "riot";
            
            // Use incoming profile directly, fallback to default if missing
            if (payload?.profile) {
                state.profile = clone(payload.profile);
            } else {
                const baseProfile = clone(fallbackData.profile);
                state.profile = baseProfile;
            }

            const baseMatches = clone(fallbackData.matches);
            const incomingMatches = payload?.matches || {};
            state.matches = {};
            for (const key of Object.keys(baseMatches)) {
                const nextMatches = Array.isArray(incomingMatches[key])
                    ? incomingMatches[key]
                    : (isLive ? [] : baseMatches[key]);
                state.matches[key] = nextMatches;
            }

            // Use incoming champions if available, otherwise fallback to demo data
            if (Array.isArray(payload?.champions) && payload.champions.length > 0) {
                state.champions = payload.champions;
            } else {
                // If no champion data available, use fallback data regardless of isLive status
                state.champions = clone(fallbackData.champions);
            }

            // Don't set leaderboard from summoner data - it's handled separately by fetchLeaderboardData
            // state.leaderboard is managed independently
            renderAll();
        }

        async function fetchSummonerData(region, name) {
            const response = await fetch(`/api/summoner?region=${encodeURIComponent(region)}&name=${encodeURIComponent(name)}`);
            const data = await response.json();
            if (!response.ok) {
                throw new Error(data?.error || "Unable to fetch summoner data.");
            }
            return data;
        }

        async function handleSearch() {
            const nameInput = document.getElementById("summonerName");
            const taglineInput = document.getElementById("summonerTagline");
            const regionSelect = document.getElementById("regionSelect");
            
            const summonerName = (nameInput.value || "").trim();
            const tagline = (taglineInput.value || "").trim();
            const region = regionSelect.value;

            if (!summonerName) {
                alert("Please enter a summoner name to search.");
                return;
            }

            // Auto-fill tagline with region if not provided
            const finalTagline = tagline || region.toUpperCase();
            
            // Construct the full name in the format "name#tagline"
            const fullSummonerName = `${summonerName}#${finalTagline}`;

            const searchButton = document.querySelector(".search-wrapper .search-btn");
            const originalContent = searchButton.innerHTML;

            searchButton.disabled = true;
            searchButton.innerHTML = "⏳";

            try {
                const data = await fetchSummonerData(region, fullSummonerName);
                applySummonerData(data);

                if (data?.meta?.reason && data.meta.source !== "riot") {
                    alert(`${data.meta.reason}\n\nShowing demo data instead.`);
                }
            } catch (error) {
                console.error(error);
                alert(error.message || "Unable to retrieve summoner data.");
            } finally {
                searchButton.disabled = false;
                searchButton.innerHTML = originalContent;
            }
        }

        function handleLogin() {
            alert("Riot Games OAuth would open a secure login window here.\n\nScope: openid offline_access lol summoner\nRedirect URI: https://yordlepedia.gg/auth/callback\n\nAfter login you would see your account avatar in the navigation bar.");
        }

        function handleDownload() {
            alert("Desktop build coming soon!\n\nYordlepedia Companion includes:\n• Real-time draft assistant\n• Objective & vision tracking overlay\n• Match recaps and highlight reel exporter\n• Configurable hotkeys and stream-safe mode");
        }

        function scrollToSection(sectionId, event) {
            console.log('scrollToSection called with:', sectionId);
            
            const section = document.getElementById(sectionId);
            if (!section) {
                console.warn('Section not found:', sectionId);
                return;
            }
            
            // Get header height
            const header = document.querySelector('header');
            const headerHeight = header ? header.offsetHeight : 80;
            
            // Special handling for search - scroll to very top
            if (sectionId === 'search') {
                console.log('Scrolling to top for search');
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                return;
            }
            
            // For other sections, scroll to just above the header
            const elementTop = section.offsetTop;
            const targetPosition = elementTop - headerHeight - 20;
            
            console.log('Scrolling to position:', targetPosition, 'for section:', sectionId);
            
            window.scrollTo({
                top: Math.max(0, targetPosition),
                behavior: 'smooth'
            });
        }

        function scrollToSearch() {
            document.getElementById("search").scrollIntoView({ behavior: "smooth" });
        }

        document.addEventListener("DOMContentLoaded", () => {
            const tabs = document.querySelectorAll(".tab-group button");
            tabs.forEach(tab => {
                tab.addEventListener("click", () => {
                    tabs.forEach(btn => btn.classList.remove("active"));
                    tab.classList.add("active");
                    activeQueue = tab.dataset.queue;
                    renderMatches(activeQueue);
                });
            });

            // Add Enter key listeners to both name and tagline inputs
            document.getElementById("summonerName").addEventListener("keypress", event => {
                if (event.key === "Enter") {
                    handleSearch();
                }
            });
            
            document.getElementById("summonerTagline").addEventListener("keypress", event => {
                if (event.key === "Enter") {
                    handleSearch();
                }
            });

            renderAll();
            prefetchDefaultSummoner();
        });

        async function fetchLeaderboardData(region = "kr") {
            console.log("fetchLeaderboardData called with region:", region);
            try {
                // Always fetch live data first
                const response = await fetch(`/api/leaderboard?region=${encodeURIComponent(region)}`);
                if (response.ok) {
                    const data = await response.json();
                    console.log("Live leaderboard data received:", data);
                    if (data.leaderboard && data.leaderboard.length > 0) {
                        console.log("First leaderboard entry:", data.leaderboard[0]);
                        state.leaderboard = data.leaderboard;
                        state.selectedRegion = region;
                        renderLeaderboard();
                        return;
                    }
                }
                
                // If live data failed, show error message instead of mock data
                console.warn("Live leaderboard data unavailable for region:", region);
                state.leaderboard = [{
                    rank: 1,
                    name: "Live data unavailable",
                    lp: "---",
                    wr: "---",
                    role: "Please try again later"
                }];
                state.selectedRegion = region;
                renderLeaderboard();
                
            } catch (error) {
                console.error("Error fetching leaderboard:", error);
                state.leaderboard = [{
                    rank: 1,
                    name: "Connection error",
                    lp: "---",
                    wr: "---",
                    role: "Please check your connection"
                }];
                state.selectedRegion = region;
                renderLeaderboard();
            }
        }

        // Make function globally accessible
        window.updateLeaderboardRegion = function(region) {
            console.log("updateLeaderboardRegion called with region:", region);
            fetchLeaderboardData(region);
        };

        async function prefetchDefaultSummoner() {
            try {
                const data = await fetchSummonerData("kr", "Faker");
                if (data?.meta?.source === "riot") {
                    applySummonerData(data);
                }
                fetchLeaderboardData("kr");
            } catch (error) {
                console.info("Continuing with demo data until Riot API is configured.", error?.message || error);
            }
        }

        function openHighlight() {
            const modal = document.getElementById('highlightModal');
            const video = document.getElementById('highlightVideo');
            const clip = (state.profile && state.profile.bannerClip) ? state.profile.bannerClip : '';
            
            if (!clip) {
                alert('No highlight banner set for this profile yet.');
                return;
            }
            
            // Clear any existing source and poster
            video.removeAttribute('poster');
            video.innerHTML = 'Your browser does not support video playback.';
            
            if (video.src !== clip) {
                video.src = clip;
            }
            modal.style.display = 'flex';
        }

        function closeHighlight() {
            const modal = document.getElementById('highlightModal');
            const video = document.getElementById('highlightVideo');
            video.pause();
            modal.style.display = 'none';
        }

        function goToHome() {
            closeHighlight();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('video/')) {
                alert('Please select a valid video file.');
                return;
            }

            const maxSize = 50 * 1024 * 1024; // 50MB limit
            if (file.size > maxSize) {
                alert('Video file size must be less than 50MB.');
                return;
            }

            const formData = new FormData();
            formData.append('video', file);
            formData.append('region', state.profile.region || 'na1');
            formData.append('name', state.profile.name || '');

            try {
                const response = await fetch('/api/upload/highlight', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Failed to upload video');
                }

                const data = await response.json();
                state.profile.bannerClip = data.url;
                renderProfile();
                alert('Video uploaded successfully!');
            } catch (error) {
                console.error('Upload error:', error);
                alert('Failed to upload video. Please try again or use a URL instead.');
            }

            // Clear the input
            event.target.value = '';
        }

        async function setBannerClip() {
            const profile = state.profile || fallbackData.profile;
            const region = (profile.region || 'na1');
            const name = profile.name || '';
            const current = profile.bannerClip || '';
            const input = prompt('Paste a direct video URL (mp4/hls) for your banner highlight:', current);
            if (input === null) return; // cancelled
            const url = (input || '').trim();
            if (!url) {
                alert('No URL provided.');
                return;
            }
            try {
                const resp = await fetch('/api/summoner/banner', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ region, name, bannerClip: url })
                });
                const data = await resp.json();
                if (!resp.ok) throw new Error(data?.error || 'Failed to set banner');
                state.profile.bannerClip = url;
                renderProfile();
                alert('Banner updated successfully.');
            } catch (e) {
                alert(e.message || 'Failed to set banner');
            }
        }

        // SIMPLE WORKING NAVIGATION - NO MORE JUMPING!
        // Simple navigation scroll handler
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Setting up navigation...');
            
            // Get all navigation links
            const navLinks = document.querySelectorAll('.nav-links a[href^="#"]');
            console.log('Found', navLinks.length, 'navigation links');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    console.log('Navigating to:', targetId);
                    
                    if (targetId === 'search') {
                        // For search, scroll all the way to the top
                        window.scrollTo({
                            top: 0,
                            behavior: 'smooth'
                        });
                    } else {
                        // For other sections, scroll to just above the header
                        const targetElement = document.getElementById(targetId);
                        if (targetElement) {
                            const headerHeight = 70; // Height of the fixed header
                            const elementTop = targetElement.getBoundingClientRect().top + window.pageYOffset;
                            const scrollToPosition = elementTop - headerHeight;
                            
                            window.scrollTo({
                                top: scrollToPosition,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
        });

        // Add mock data for champions
        const mockChampions = [
            {
                name: "Ahri",
                role: "Mid",
                games: 245,
                winRate: "58%",
                kda: "4.8",
                masteryLevel: 7,
                badges: ["Most Played", "Best KDA"]
            },
            {
                name: "Zed",
                role: "Mid",
                games: 189,
                winRate: "62%",
                kda: "5.2",
                masteryLevel: 7,
                badges: ["Highest Win Rate"]
            },
            {
                name: "Syndra",
                role: "Mid",
                games: 167,
                winRate: "55%",
                kda: "4.1",
                masteryLevel: 7
            },
            {
                name: "LeBlanc",
                role: "Mid",
                games: 156,
                winRate: "59%",
                kda: "4.6",
                masteryLevel: 7
            },
            {
                name: "Orianna",
                role: "Mid",
                games: 134,
                winRate: "57%",
                kda: "4.4",
                masteryLevel: 7
            }
        ];

        // Use mock data when no champions are available
        if (!state.champions || !state.champions.length) {
            state.champions = mockChampions;
        }
    </script>
    <style>
        .champ-card {
            position: relative;
            padding: 24px;
            min-height: 320px;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            gap: 12px;
            transition: all 0.3s ease;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .champ-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                180deg,
                transparent 0%,
                rgba(0, 0, 0, 0.5) 50%,
                rgba(0, 0, 0, 0.95) 100%
            );
            z-index: 1;
        }

        .champ-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background-image: var(--champ-splash);
            background-position: center 20%;
            background-size: cover;
            background-repeat: no-repeat;
            z-index: 0;
            filter: brightness(0.95);
            transition: transform 0.5s ease;
        }

        .champ-card:hover::after {
            transform: scale(1.1);
        }

        .champ-card > * {
            position: relative;
            z-index: 2;
            color: white;
        }

        .champ-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        .mastery-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--accent);
            border-radius: 50%;
            color: var(--accent);
            font-weight: bold;
            font-size: 16px;
            z-index: 2;
            backdrop-filter: blur(4px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            cursor: help;
            transition: all 0.2s ease;
        }

        .mastery-badge:hover {
            transform: scale(1.1);
            background: rgba(0, 0, 0, 0.9);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }
        
        .stat-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: white;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .champ-card.fallback-icon::after {
            background-size: 50%;
            background-position: center 30%;
        }
    </style>

    <!-- Match Details Modal -->
    <div id="matchDetailsModal" class="match-details-modal">
        <div class="match-details-content">
            <div class="match-details-header">
                <h2>Match Details</h2>
                <button class="close-btn" onclick="closeMatchDetails()">✕ Close</button>
            </div>
            
            <div class="match-overview">
                <div class="team-score-section">
                    <div class="team-score blue-score" id="blueTeamScore">0</div>
                    <div class="score-label">Blue Team Kills</div>
                </div>
                <div class="match-info">
                    <div class="duration" id="matchDuration">--:--</div>
                    <div class="game-mode" id="gameMode">Loading...</div>
                </div>
                <div class="team-score-section">
                    <div class="team-score red-score" id="redTeamScore">0</div>
                    <div class="score-label">Red Team Kills</div>
                </div>
            </div>

            <div class="teams-container">
                <div class="team-section blue-team">
                    <div class="team-header">
                        <span class="team-name blue">Blue Team</span>
                        <span class="team-kda" id="blueTeamKDA">0/0/0</span>
                    </div>
                    <div class="players-list" id="blueTeamPlayers">
                        <!-- Blue team players will be populated here -->
                    </div>
                </div>

                <div class="team-section red-team">
                    <div class="team-header">
                        <span class="team-name red">Red Team</span>
                        <span class="team-kda" id="redTeamKDA">0/0/0</span>
                    </div>
                    <div class="players-list" id="redTeamPlayers">
                        <!-- Red team players will be populated here -->
                    </div>
                </div>
            </div>

            <div class="objectives-section">
                <h3 style="text-align: center; margin-bottom: 16px; color: var(--accent);">Objectives</h3>
                <div class="objectives-grid">
                    <div class="objectives-team" id="blueObjectives">
                        <!-- Blue team objectives -->
                    </div>
                    <div class="objectives-team" id="redObjectives">
                        <!-- Red team objectives -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
